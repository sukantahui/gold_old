!function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(r=n.key,i=void 0,"symbol"==typeof(i=function(e,t){if("object"!=typeof e||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"))?i:String(i)),n)}var r,i}function o(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(self.webpackChunkaccounts=self.webpackChunkaccounts||[]).push([[3929],{33929:function(t,n,r){r.r(n),r.d(n,{GoldReceivedModule:function(){return j}});var i=r(38583),u=r(63423),a=r(92340),s=r(3679),l=r(88259),c=r.n(l),d=r(37716),g=r(52541),p=r(82820),m=r(30535),Z=r(86640),f=r(82613),v=r(98295),_=r(49983),h=r(51095),A=r(26584),q=r(33013),b=r(95913),T=r(76627);function x(e,t){if(1&e&&(d.TgZ(0,"div",25),d.TgZ(1,"div"),d.TgZ(2,"div"),d._uU(3),d.qZA(),d.TgZ(4,"div"),d._uU(5),d.qZA(),d.TgZ(6,"div"),d._uU(7),d.qZA(),d.qZA(),d.TgZ(8,"div"),d.TgZ(9,"span"),d._uU(10),d.ALo(11,"number"),d.qZA(),d._uU(12," and "),d.TgZ(13,"span"),d._uU(14),d.qZA(),d.qZA(),d.qZA()),2&e){var o=d.oxw();d.xp6(3),d.hij("Customer Code: ",o.selectedCustomer.cust_id,""),d.xp6(2),d.hij("Customer: ",o.selectedCustomer.cust_name,""),d.xp6(2),d.hij("Customer: ",o.selectedCustomer.cust_phone,""),d.xp6(3),d.hij(" Gold Due: ",d.xi3(11,5,o.customerDues.gold_due,"1.3")," gm. "),d.xp6(4),d.hij(" LC Due: Rs. ",o.customerDues.lc_due,"")}}function R(e,t){1&e&&(d.TgZ(0,"mat-radio-button",26),d._uU(1,"In Gold"),d.qZA())}function C(e,t){1&e&&(d.TgZ(0,"mat-radio-button",27),d._uU(1,"In Cash"),d.qZA())}function y(e,t){1&e&&(d.TgZ(0,"mat-radio-button",28),d._uU(1,"Virtual Gold"),d.qZA())}function w(e,t){if(1&e){var o=d.EpF();d.TgZ(0,"div"),d.TgZ(1,"div"),d.TgZ(2,"mat-form-field",11),d.TgZ(3,"mat-label"),d._uU(4,"Enter Gold Rate(10Gm)"),d.qZA(),d.TgZ(5,"input",29,30),d.NdJ("keyup",function(){d.CHM(o);var e=d.MAs(6),t=d.MAs(12);return d.oxw().onGoldRateChange(e,t)}),d.qZA(),d.qZA(),d.qZA(),d.TgZ(7,"div"),d.TgZ(8,"mat-form-field",11),d.TgZ(9,"mat-label"),d._uU(10,"Enter Cash against Gold"),d.qZA(),d.TgZ(11,"input",31,32),d.NdJ("keyup",function(){d.CHM(o);var e=d.MAs(6),t=d.MAs(12);return d.oxw().onGoldRateChange(e,t)}),d.qZA(),d.qZA(),d.qZA(),d.qZA()}}function U(e,t){if(1&e&&(d.TgZ(0,"div",33),d.TgZ(1,"button",34),d.TgZ(2,"mat-icon"),d._uU(3,"print"),d.qZA(),d.qZA(),d.TgZ(4,"table"),d.TgZ(5,"thead"),d.TgZ(6,"tr"),d.TgZ(7,"td"),d._uU(8,"Gold Receipt ID: "),d.qZA(),d.TgZ(9,"th",35),d._uU(10),d.qZA(),d.qZA(),d.TgZ(11,"tr"),d.TgZ(12,"td"),d._uU(13,"Customer ID: "),d.qZA(),d.TgZ(14,"td"),d.TgZ(15,"strong"),d._uU(16),d.qZA(),d.qZA(),d.qZA(),d.TgZ(17,"tr"),d.TgZ(18,"td"),d._uU(19,"Customer: "),d.qZA(),d.TgZ(20,"td"),d._uU(21),d.qZA(),d.qZA(),d.TgZ(22,"tr"),d.TgZ(23,"td"),d._uU(24,"Address: "),d.qZA(),d.TgZ(25,"td"),d._uU(26),d.qZA(),d.qZA(),d.TgZ(27,"tr"),d.TgZ(28,"td"),d._uU(29,"City: "),d.qZA(),d.TgZ(30,"td"),d._uU(31),d.qZA(),d.qZA(),d.TgZ(32,"tr"),d.TgZ(33,"td"),d._uU(34,"Carrier: "),d.qZA(),d.TgZ(35,"td"),d._uU(36),d.qZA(),d.qZA(),d.TgZ(37,"tr"),d.TgZ(38,"td"),d._uU(39,"Received by: "),d.qZA(),d.TgZ(40,"td"),d._uU(41),d.qZA(),d.qZA(),d.TgZ(42,"tr"),d.TgZ(43,"td"),d._uU(44,"Date: "),d.qZA(),d.TgZ(45,"td"),d._uU(46),d.ALo(47,"number"),d.qZA(),d.qZA(),d.qZA(),d.TgZ(48,"tbody"),d.TgZ(49,"tr"),d.TgZ(50,"td"),d._uU(51,"Previous Gold Due: "),d.qZA(),d.TgZ(52,"td",36),d._uU(53),d.ALo(54,"number"),d.qZA(),d.qZA(),d.TgZ(55,"tr"),d.TgZ(56,"td"),d._uU(57,"Less: Gold Received: "),d.qZA(),d.TgZ(58,"td",36),d._uU(59),d.ALo(60,"number"),d.qZA(),d.qZA(),d.TgZ(61,"tr"),d._UZ(62,"td",37),d.qZA(),d.TgZ(63,"tr"),d.TgZ(64,"td"),d._uU(65,"Current Gold Due: "),d.qZA(),d.TgZ(66,"td",36),d._uU(67),d.ALo(68,"number"),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA()),2&e){var o=d.oxw();d.xp6(1),d.Q6J("useExistingCss",!1),d.xp6(9),d.Oqu(o.afterSaveResponse.gold_receipt.gold_receipt_id),d.xp6(6),d.Oqu(o.afterSaveResponse.customer.cust_id),d.xp6(5),d.Oqu(o.afterSaveResponse.customer.mailing_name),d.xp6(5),d.Oqu(o.afterSaveResponse.customer.cust_address),d.xp6(5),d.Oqu(o.afterSaveResponse.customer.city),d.xp6(5),d.Oqu(o.afterSaveResponse.agent.agent_name),d.xp6(5),d.Oqu(o.afterSaveResponse.employee.emp_name),d.xp6(5),d.Oqu(d.xi3(47,12,o.afterSaveResponse.gold_receipt.tr_date,"0.3-3")),d.xp6(7),d.Oqu(d.xi3(54,15,o.afterSaveResponse.gold_receipt.last_gold_balance,"0.3-3")),d.xp6(6),d.Oqu(d.xi3(60,18,o.afterSaveResponse.gold_receipt.gold_value,"0.3-3")),d.xp6(8),d.Oqu(d.xi3(68,21,o.afterSaveResponse.gold_receipt.last_gold_balance-o.afterSaveResponse.gold_receipt.gold_value,"0.3-3"))}}function S(e,t){1&e&&(d.TgZ(0,"h3"),d._uU(1,"Gold Receipts"),d.qZA())}function I(e,t){1&e&&(d.TgZ(0,"h3"),d._uU(1,"No Receipts recorded"),d.qZA())}function N(e,t){1&e&&(d.TgZ(0,"tr"),d.TgZ(1,"th"),d._uU(2,"Date"),d.qZA(),d.TgZ(3,"th"),d._uU(4,"Receipt No."),d.qZA(),d.TgZ(5,"th"),d._uU(6,"Gold"),d.qZA(),d.qZA())}function k(e,t){if(1&e){var o=d.EpF();d.TgZ(0,"tr"),d.TgZ(1,"td"),d._uU(2),d.qZA(),d.TgZ(3,"td",38),d.TgZ(4,"a",39),d.NdJ("click",function(){var e=d.CHM(o).$implicit;return d.oxw().onGoldReceiptSelected(e)}),d._uU(5),d.qZA(),d.qZA(),d.TgZ(6,"td",38),d._uU(7),d.ALo(8,"number"),d.qZA(),d.qZA()}if(2&e){var n=t.$implicit;d.xp6(2),d.hij(" ",n.gold_receipt_date," "),d.xp6(3),d.Oqu(n.gold_receipt_id),d.xp6(2),d.hij(" ",d.xi3(8,3,n.gold_value,"0.3-3")," gm ")}}function G(e,t){if(1&e&&(d.TgZ(0,"div",40),d.TgZ(1,"div",0),d.TgZ(2,"div",41),d.TgZ(3,"pre"),d._uU(4),d.ALo(5,"json"),d.ALo(6,"json"),d.ALo(7,"json"),d.qZA(),d.qZA(),d.TgZ(8,"div",41),d.TgZ(9,"pre"),d._uU(10),d.ALo(11,"json"),d.qZA(),d.qZA(),d.TgZ(12,"div",41),d.TgZ(13,"pre"),d._uU(14),d.ALo(15,"json"),d.qZA(),d.qZA(),d.qZA(),d.qZA()),2&e){var o=d.oxw();d.xp6(4),d.lnq("                goldReceiptForm=",d.lcZ(5,5,o.goldReceiptForm.value),"\n                goldReceiptForm.valid=",d.lcZ(6,7,o.goldReceiptForm.valid),"\n                selectedCustomer=",d.lcZ(7,9,o.selectedCustomer),"\n            "),d.xp6(6),d.hij("                afterSaveResponse= ",d.lcZ(11,11,o.afterSaveResponse),"\n            "),d.xp6(4),d.hij("                goldReceipts= ",d.lcZ(15,13,o.goldReceipts),"\n            ")}}var J,D=[{path:"",component:(J=function(){function t(o,n,r,u){var l=this;e(this,t),this.route=o,this.customerService=n,this.reportService=r,this.receiptService=u,this.isProduction=a.N.production,this.afterSaveResponse=null,this.selectedCustomer=null,this.showCashEntry=!1,this.printDivStyle={table:{"border-collapse":"collapse",width:"100%"},label:{width:"100%"},th:{border:"1px  solid black",fontSize:"small"},td:{border:"1px  solid black",fontSize:"small"},noPrint:{display:"none"}},this.route.data.subscribe(function(e){l.agents=e.goldReceiptResolver.agents.data,l.customers=e.goldReceiptResolver.customers.data});var c=new Date,d=(0,i.p6)(c,"yyyy-MM-dd","en");this.goldReceiptForm=new s.cw({gold_receipt_date:new s.NI(d),agent_id:new s.NI(null,[s.kI.required]),cust_id:new s.NI(null,[s.kI.required]),rm_id:new s.NI(36,[s.kI.required]),payment_mode:new s.NI("1",[s.kI.required]),gold_value:new s.NI(null,[s.kI.required,s.kI.min(.001)]),discount:new s.NI(0),gold_rate:new s.NI(6e4),cash:new s.NI(0),last_gold_balance:new s.NI(0,[s.kI.required]),current_lc_balance:new s.NI(0,[s.kI.required])})}return o(t,[{key:"ngOnInit",value:function(){var e=this;this.goldReceiptForm.get("payment_mode").valueChanges.subscribe(function(t){e.goldReceiptForm.patchValue({gold_value:null}),e.showCashEntry="4"===t})}},{key:"agentSelected",value:function(){}},{key:"onCustomerSelected",value:function(e){var t=this;if(this.selectedCustomer=e,this.afterSaveResponse=null,!this.selectedCustomer)return this.customerDues=null,void(this.goldReceipts=null);this.goldReceiptForm.patchValue(1===this.selectedCustomer.is_stock_customer?{payment_mode:"5"}:{payment_mode:"1"}),this.customerService.getCustomerDues(e.cust_id).subscribe(function(e){t.customerDues=e.data,t.goldReceiptForm.patchValue({last_gold_balance:t.customerDues.gold_due,current_lc_balance:t.customerDues.lc_due})}),this.receiptService.getGoldReceiptsByCustomer(e.cust_id).subscribe(function(e){t.goldReceipts=e.data})}},{key:"saveGoldReceipt",value:function(){var e=this;c().fire({title:"Do you want to save the changes?",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Save",denyButtonText:"Don't save"}).then(function(t){t.isConfirmed?e.receiptService.saveGoldReceipt(e.goldReceiptForm.value).subscribe(function(t){!0===t.status&&(e.customerDues.lc_due=e.customerDues.lc_due-e.goldReceiptForm.value.amount,e.afterSaveResponse=t.data,e.goldReceiptForm.markAsPristine(),e.goldReceipts.unshift(e.afterSaveResponse.gold_receipt),e.goldReceiptForm.reset(),e.customerDues=null,c().fire({title:"<strong>Gold Receipt Enter Successfully<u>example</u></strong>",icon:"info",html:'You can use <b>bold text</b>,<a href="#" autofocus>links</a>, and other HTML tags',showCloseButton:!0,showCancelButton:!0,focusConfirm:!1,confirmButtonText:'<i class="fa fa-thumbs-up"></i> Great!',confirmButtonAriaLabel:"Thumbs up, great!",cancelButtonText:'<i class="fa fa-thumbs-down"></i>Cancel',cancelButtonAriaLabel:"Thumbs down"}))},function(e){c().fire({title:"Error Saving Gold Received",text:"Error saving Gold Receipt",icon:"error"})}):t.isDenied&&c().fire("Changes are not saved","","info")})}},{key:"resetForm",value:function(){this.goldReceiptForm.reset(),this.customerDues=null}},{key:"onGoldRateChange",value:function(e,t){if(console.log("Gold rate",e.value),console.log("cash",t.value),Number(t.value)>0&&Number(e.value)>0){var o=(Number(t.value)/(Number(e.value)/10)).toFixed(3);this.goldReceiptForm.patchValue({gold_value:o})}else this.goldReceiptForm.patchValue({gold_value:null})}},{key:"onGoldReceiptSelected",value:function(e){var t=this;this.receiptService.getGoldReceiptDetailsByID(e.gold_receipt_id).subscribe(function(e){t.afterSaveResponse=e.data})}}]),t}(),J.\u0275fac=function(e){return new(e||J)(d.Y36(u.gz),d.Y36(g.v),d.Y36(p.r),d.Y36(m.V))},J.\u0275cmp=d.Xpm({type:J,selectors:[["app-gold-received"]],decls:36,vars:16,consts:[[1,"d-flex","flex-row"],[1,"p-2","col-4"],[3,"formGroup"],["bindLabel","agent_name","bindValue","agent_id","formControlName","agent_id","placeholder","Select Agent",1,"custom",3,"items","change"],["bindLabel","cust_name","bindValue","cust_id","formControlName","cust_id","placeholder","Select Customer",1,"custom",3,"items","change"],["class","border-glow",4,"ngIf"],["aria-label","Select an option","formControlName","payment_mode",1,"payment-mode"],["value","1",4,"ngIf"],["value","4",4,"ngIf"],["value","5",4,"ngIf"],[4,"ngIf"],[1,"example-full-width"],["type","number","step","0.001","matInput","","formControlName","gold_value","placeholder","Gold Value",1,"text-right",3,"readonly"],[1,"d-flex","flex-row","bd-highlight","mb-3"],[1,"p-2","bd-highlight"],[1,"example-button-row"],["mat-raised-button","","color","accent",1,"text-right",3,"disabled","click"],["mat-raised-button","","color","primary",1,"text-right",3,"disabled","click"],["class","border-glow","id","print-gold-receipt",4,"ngIf"],[1,"p-2","col-8"],[3,"value"],["myTab",""],["pTemplate","header"],["pTemplate","body"],["id","developer-div",4,"ngIf"],[1,"border-glow"],["value","1"],["value","4"],["value","5"],["type","number","matInput","","formControlName","gold_rate","placeholder","Gold Rate",1,"text-right",3,"keyup"],["goldRate",""],["type","number","matInput","","formControlName","cash","placeholder","Cash",1,"text-right",3,"keyup"],["cash",""],["id","print-gold-receipt",1,"border-glow"],["mat-button","","color","primary","printSectionId","print-gold-receipt","styleSheetFile","assets/print_css/gold_receipt/style1.css","ngxPrint","",1,"no-print",3,"useExistingCss"],[2,"padding","5px"],[2,"text-align","right"],["colspan","2",2,"border-top","1px solid black"],[1,"text-right"],[3,"routerLink","click"],["id","developer-div"],[1,"p-2"]],template:function(e,t){1&e&&(d.TgZ(0,"div",0),d.TgZ(1,"div",1),d.TgZ(2,"div"),d.TgZ(3,"form",2),d.TgZ(4,"ng-select",3),d.NdJ("change",function(){return t.agentSelected()}),d.qZA(),d.TgZ(5,"ng-select",4),d.NdJ("change",function(e){return t.onCustomerSelected(e)}),d.qZA(),d.YNc(6,x,15,8,"div",5),d.TgZ(7,"div"),d.TgZ(8,"mat-radio-group",6),d.YNc(9,R,2,0,"mat-radio-button",7),d.YNc(10,C,2,0,"mat-radio-button",8),d.YNc(11,y,2,0,"mat-radio-button",9),d.qZA(),d.qZA(),d.YNc(12,w,13,0,"div",10),d.TgZ(13,"div"),d.TgZ(14,"mat-form-field",11),d.TgZ(15,"mat-label"),d._uU(16,"Enter Gold Received"),d.qZA(),d._UZ(17,"input",12),d.qZA(),d.qZA(),d.TgZ(18,"div",13),d.TgZ(19,"div",14),d.TgZ(20,"div",15),d.TgZ(21,"button",16),d.NdJ("click",function(){return t.resetForm()}),d._uU(22,"Reset"),d.qZA(),d.qZA(),d.qZA(),d.TgZ(23,"div",14),d.TgZ(24,"div",15),d.TgZ(25,"button",17),d.NdJ("click",function(){return t.saveGoldReceipt()}),d._uU(26,"Save Record"),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.YNc(27,U,69,24,"div",18),d.qZA(),d.TgZ(28,"div",19),d.YNc(29,S,2,0,"h3",10),d.YNc(30,I,2,0,"h3",10),d.TgZ(31,"p-table",20,21),d.YNc(33,N,7,0,"ng-template",22),d.YNc(34,k,9,6,"ng-template",23),d.qZA(),d.qZA(),d.qZA(),d.YNc(35,G,16,15,"div",24)),2&e&&(d.xp6(3),d.Q6J("formGroup",t.goldReceiptForm),d.xp6(1),d.Q6J("items",t.agents),d.xp6(1),d.Q6J("items",t.customers),d.xp6(1),d.Q6J("ngIf",t.customerDues),d.xp6(3),d.Q6J("ngIf",t.selectedCustomer&&0==t.selectedCustomer.is_stock_customer),d.xp6(1),d.Q6J("ngIf",t.selectedCustomer&&0==t.selectedCustomer.is_stock_customer),d.xp6(1),d.Q6J("ngIf",t.selectedCustomer&&1==t.selectedCustomer.is_stock_customer),d.xp6(1),d.Q6J("ngIf",t.showCashEntry),d.xp6(5),d.Q6J("readonly",t.showCashEntry),d.xp6(4),d.Q6J("disabled",t.goldReceiptForm.pristine),d.xp6(4),d.Q6J("disabled",!t.goldReceiptForm.valid||t.goldReceiptForm.pristine),d.xp6(2),d.Q6J("ngIf",t.afterSaveResponse),d.xp6(2),d.Q6J("ngIf",t.goldReceipts&&t.goldReceipts.length>0),d.xp6(1),d.Q6J("ngIf",!t.goldReceipts||0==t.goldReceipts.length),d.xp6(1),d.Q6J("value",t.goldReceipts),d.xp6(4),d.Q6J("ngIf",!t.isProduction))},directives:[s._Y,s.JL,s.sg,Z.w9,s.JJ,s.u,i.O5,f.VQ,v.KE,v.hX,s.wV,_.Nt,s.Fj,h.lW,A.iA,q.jx,f.U0,b.I,T.Hw,u.yS],pipes:[i.JJ,i.Ts],styles:[".payment-mode[_ngcontent-%COMP%]   mat-radio-button[_ngcontent-%COMP%]{margin-left:16px}.border-glow[_ngcontent-%COMP%]{padding:2px;border-color:#28a745;box-shadow:0 0 0 .2rem #28a74540;border-radius:5px;margin-bottom:5px}input[_ngcontent-%COMP%]::-webkit-outer-spin-button, input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}"]}),J)}],F=function(){var t=o(function t(){e(this,t)});return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=d.oAB({type:t}),t.\u0275inj=d.cJS({imports:[[u.Bz.forChild(D)],u.Bz]}),t}(),j=function(){var t=o(function t(){e(this,t)});return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=d.oAB({type:t}),t.\u0275inj=d.cJS({imports:[[i.ez,F,s.UX,Z.A0,v.lN,f.Fk,T.Ps,b.K,h.ot,_.c,A.U$]]}),t}()}}])}();