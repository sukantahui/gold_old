"use strict";(self.webpackChunkaccounts=self.webpackChunkaccounts||[]).push([[3929],{33929:function(e,t,o){o.r(t),o.d(t,{GoldReceivedModule:function(){return J}});var i=o(38583),s=o(63423),n=o(92340),r=o(3679),l=o(88259),u=o.n(l),a=o(37716),d=o(52541),c=o(82820),g=o(30535),p=o(86640),Z=o(82613),m=o(98295),h=o(49983),_=o(51095),A=o(26584),q=o(33013),f=o(95913),v=o(76627);function T(e,t){if(1&e&&(a.TgZ(0,"div",25),a.TgZ(1,"div"),a.TgZ(2,"div"),a._uU(3),a.qZA(),a.TgZ(4,"div"),a._uU(5),a.qZA(),a.TgZ(6,"div"),a._uU(7),a.qZA(),a.qZA(),a.TgZ(8,"div"),a.TgZ(9,"span"),a._uU(10),a.ALo(11,"number"),a.qZA(),a._uU(12," and "),a.TgZ(13,"span"),a._uU(14),a.qZA(),a.qZA(),a.qZA()),2&e){const e=a.oxw();a.xp6(3),a.hij("Customer Code: ",e.selectedCustomer.cust_id,""),a.xp6(2),a.hij("Customer: ",e.selectedCustomer.cust_name,""),a.xp6(2),a.hij("Customer: ",e.selectedCustomer.cust_phone,""),a.xp6(3),a.hij(" Gold Due: ",a.xi3(11,5,e.customerDues.gold_due,"1.3")," gm. "),a.xp6(4),a.hij(" LC Due: Rs. ",e.customerDues.lc_due,"")}}function b(e,t){1&e&&(a.TgZ(0,"mat-radio-button",26),a._uU(1,"In Gold"),a.qZA())}function x(e,t){1&e&&(a.TgZ(0,"mat-radio-button",27),a._uU(1,"In Cash"),a.qZA())}function R(e,t){1&e&&(a.TgZ(0,"mat-radio-button",28),a._uU(1,"Virtual Gold"),a.qZA())}function C(e,t){if(1&e){const e=a.EpF();a.TgZ(0,"div"),a.TgZ(1,"div"),a.TgZ(2,"mat-form-field",11),a.TgZ(3,"mat-label"),a._uU(4,"Enter Gold Rate(10Gm)"),a.qZA(),a.TgZ(5,"input",29,30),a.NdJ("keyup",function(){a.CHM(e);const t=a.MAs(6),o=a.MAs(12);return a.oxw().onGoldRateChange(t,o)}),a.qZA(),a.qZA(),a.qZA(),a.TgZ(7,"div"),a.TgZ(8,"mat-form-field",11),a.TgZ(9,"mat-label"),a._uU(10,"Enter Cash against Gold"),a.qZA(),a.TgZ(11,"input",31,32),a.NdJ("keyup",function(){a.CHM(e);const t=a.MAs(6),o=a.MAs(12);return a.oxw().onGoldRateChange(t,o)}),a.qZA(),a.qZA(),a.qZA(),a.qZA()}}function w(e,t){if(1&e&&(a.TgZ(0,"div",33),a.TgZ(1,"button",34),a.TgZ(2,"mat-icon"),a._uU(3,"print"),a.qZA(),a.qZA(),a.TgZ(4,"table"),a.TgZ(5,"thead"),a.TgZ(6,"tr"),a.TgZ(7,"td"),a._uU(8,"Gold Receipt ID: "),a.qZA(),a.TgZ(9,"th",35),a._uU(10),a.qZA(),a.qZA(),a.TgZ(11,"tr"),a.TgZ(12,"td"),a._uU(13,"Customer ID: "),a.qZA(),a.TgZ(14,"td"),a.TgZ(15,"strong"),a._uU(16),a.qZA(),a.qZA(),a.qZA(),a.TgZ(17,"tr"),a.TgZ(18,"td"),a._uU(19,"Customer: "),a.qZA(),a.TgZ(20,"td"),a._uU(21),a.qZA(),a.qZA(),a.TgZ(22,"tr"),a.TgZ(23,"td"),a._uU(24,"Address: "),a.qZA(),a.TgZ(25,"td"),a._uU(26),a.qZA(),a.qZA(),a.TgZ(27,"tr"),a.TgZ(28,"td"),a._uU(29,"City: "),a.qZA(),a.TgZ(30,"td"),a._uU(31),a.qZA(),a.qZA(),a.TgZ(32,"tr"),a.TgZ(33,"td"),a._uU(34,"Carrier: "),a.qZA(),a.TgZ(35,"td"),a._uU(36),a.qZA(),a.qZA(),a.TgZ(37,"tr"),a.TgZ(38,"td"),a._uU(39,"Received by: "),a.qZA(),a.TgZ(40,"td"),a._uU(41),a.qZA(),a.qZA(),a.TgZ(42,"tr"),a.TgZ(43,"td"),a._uU(44,"Date: "),a.qZA(),a.TgZ(45,"td"),a._uU(46),a.ALo(47,"number"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(48,"tbody"),a.TgZ(49,"tr"),a.TgZ(50,"td"),a._uU(51,"Previous Gold Due: "),a.qZA(),a.TgZ(52,"td",36),a._uU(53),a.ALo(54,"number"),a.qZA(),a.qZA(),a.TgZ(55,"tr"),a.TgZ(56,"td"),a._uU(57,"Less: Gold Received: "),a.qZA(),a.TgZ(58,"td",36),a._uU(59),a.ALo(60,"number"),a.qZA(),a.qZA(),a.TgZ(61,"tr"),a._UZ(62,"td",37),a.qZA(),a.TgZ(63,"tr"),a.TgZ(64,"td"),a._uU(65,"Current Gold Due: "),a.qZA(),a.TgZ(66,"td",36),a._uU(67),a.ALo(68,"number"),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA()),2&e){const e=a.oxw();a.xp6(1),a.Q6J("useExistingCss",!1),a.xp6(9),a.Oqu(e.afterSaveResponse.gold_receipt.gold_receipt_id),a.xp6(6),a.Oqu(e.afterSaveResponse.customer.cust_id),a.xp6(5),a.Oqu(e.afterSaveResponse.customer.mailing_name),a.xp6(5),a.Oqu(e.afterSaveResponse.customer.cust_address),a.xp6(5),a.Oqu(e.afterSaveResponse.customer.city),a.xp6(5),a.Oqu(e.afterSaveResponse.agent.agent_name),a.xp6(5),a.Oqu(e.afterSaveResponse.employee.emp_name),a.xp6(5),a.Oqu(a.xi3(47,12,e.afterSaveResponse.gold_receipt.tr_date,"0.3-3")),a.xp6(7),a.Oqu(a.xi3(54,15,e.afterSaveResponse.gold_receipt.last_gold_balance,"0.3-3")),a.xp6(6),a.Oqu(a.xi3(60,18,e.afterSaveResponse.gold_receipt.gold_value,"0.3-3")),a.xp6(8),a.Oqu(a.xi3(68,21,e.afterSaveResponse.gold_receipt.last_gold_balance-e.afterSaveResponse.gold_receipt.gold_value,"0.3-3"))}}function U(e,t){1&e&&(a.TgZ(0,"h3"),a._uU(1,"Gold Receipts"),a.qZA())}function y(e,t){1&e&&(a.TgZ(0,"h3"),a._uU(1,"No Receipts recorded"),a.qZA())}function S(e,t){1&e&&(a.TgZ(0,"tr"),a.TgZ(1,"th"),a._uU(2,"Date"),a.qZA(),a.TgZ(3,"th"),a._uU(4,"Receipt No."),a.qZA(),a.TgZ(5,"th"),a._uU(6,"Gold"),a.qZA(),a.qZA())}function I(e,t){if(1&e){const e=a.EpF();a.TgZ(0,"tr"),a.TgZ(1,"td"),a._uU(2),a.qZA(),a.TgZ(3,"td",38),a.TgZ(4,"a",39),a.NdJ("click",function(){const t=a.CHM(e).$implicit;return a.oxw().onGoldReceiptSelected(t)}),a._uU(5),a.qZA(),a.qZA(),a.TgZ(6,"td",38),a._uU(7),a.ALo(8,"number"),a.qZA(),a.qZA()}if(2&e){const e=t.$implicit;a.xp6(2),a.hij(" ",e.gold_receipt_date," "),a.xp6(3),a.Oqu(e.gold_receipt_id),a.xp6(2),a.hij(" ",a.xi3(8,3,e.gold_value,"0.3-3")," gm ")}}function N(e,t){if(1&e&&(a.TgZ(0,"div",40),a.TgZ(1,"div",0),a.TgZ(2,"div",41),a.TgZ(3,"pre"),a._uU(4),a.ALo(5,"json"),a.ALo(6,"json"),a.ALo(7,"json"),a.qZA(),a.qZA(),a.TgZ(8,"div",41),a.TgZ(9,"pre"),a._uU(10),a.ALo(11,"json"),a.qZA(),a.qZA(),a.TgZ(12,"div",41),a.TgZ(13,"pre"),a._uU(14),a.ALo(15,"json"),a.qZA(),a.qZA(),a.qZA(),a.qZA()),2&e){const e=a.oxw();a.xp6(4),a.lnq("                goldReceiptForm=",a.lcZ(5,5,e.goldReceiptForm.value),"\n                goldReceiptForm.valid=",a.lcZ(6,7,e.goldReceiptForm.valid),"\n                selectedCustomer=",a.lcZ(7,9,e.selectedCustomer),"\n            "),a.xp6(6),a.hij("                afterSaveResponse= ",a.lcZ(11,11,e.afterSaveResponse),"\n            "),a.xp6(4),a.hij("                goldReceipts= ",a.lcZ(15,13,e.goldReceipts),"\n            ")}}const k=[{path:"",component:(()=>{class e{constructor(e,t,o,s){this.route=e,this.customerService=t,this.reportService=o,this.receiptService=s,this.isProduction=n.N.production,this.afterSaveResponse=null,this.selectedCustomer=null,this.showCashEntry=!1,this.printDivStyle={table:{"border-collapse":"collapse",width:"100%"},label:{width:"100%"},th:{border:"1px  solid black",fontSize:"small"},td:{border:"1px  solid black",fontSize:"small"},noPrint:{display:"none"}},this.route.data.subscribe(e=>{this.agents=e.goldReceiptResolver.agents.data,this.customers=e.goldReceiptResolver.customers.data});const l=new Date,u=(0,i.p6)(l,"yyyy-MM-dd","en");this.goldReceiptForm=new r.cw({gold_receipt_date:new r.NI(u),agent_id:new r.NI(null,[r.kI.required]),cust_id:new r.NI(null,[r.kI.required]),rm_id:new r.NI(36,[r.kI.required]),payment_mode:new r.NI("1",[r.kI.required]),gold_value:new r.NI(null,[r.kI.required,r.kI.min(.001)]),discount:new r.NI(0),gold_rate:new r.NI(6e4),cash:new r.NI(0),last_gold_balance:new r.NI(0,[r.kI.required]),current_lc_balance:new r.NI(0,[r.kI.required])})}ngOnInit(){this.goldReceiptForm.get("payment_mode").valueChanges.subscribe(e=>{this.goldReceiptForm.patchValue({gold_value:null}),this.showCashEntry="4"===e})}agentSelected(){}onCustomerSelected(e){if(this.selectedCustomer=e,this.afterSaveResponse=null,!this.selectedCustomer)return this.customerDues=null,void(this.goldReceipts=null);this.goldReceiptForm.patchValue(1===this.selectedCustomer.is_stock_customer?{payment_mode:"5"}:{payment_mode:"1"}),this.customerService.getCustomerDues(e.cust_id).subscribe(e=>{this.customerDues=e.data,this.goldReceiptForm.patchValue({last_gold_balance:this.customerDues.gold_due,current_lc_balance:this.customerDues.lc_due})}),this.receiptService.getGoldReceiptsByCustomer(e.cust_id).subscribe(e=>{this.goldReceipts=e.data})}saveGoldReceipt(){u().fire({title:"Do you want to save the changes?",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Save",denyButtonText:"Don't save"}).then(e=>{e.isConfirmed?this.receiptService.saveGoldReceipt(this.goldReceiptForm.value).subscribe(e=>{!0===e.status&&(this.customerDues.lc_due=this.customerDues.lc_due-this.goldReceiptForm.value.amount,this.afterSaveResponse=e.data,this.goldReceiptForm.markAsPristine(),this.goldReceipts.unshift(this.afterSaveResponse.gold_receipt),this.goldReceiptForm.reset(),this.customerDues=null,u().fire({title:"<strong>Gold Receipt Enter Successfully<u>example</u></strong>",icon:"info",html:'You can use <b>bold text</b>,<a href="#" autofocus>links</a>, and other HTML tags',showCloseButton:!0,showCancelButton:!0,focusConfirm:!1,confirmButtonText:'<i class="fa fa-thumbs-up"></i> Great!',confirmButtonAriaLabel:"Thumbs up, great!",cancelButtonText:'<i class="fa fa-thumbs-down"></i>Cancel',cancelButtonAriaLabel:"Thumbs down"}))},e=>{u().fire({title:"Error Saving Gold Received",text:"Error saving Gold Receipt",icon:"error"})}):e.isDenied&&u().fire("Changes are not saved","","info")})}resetForm(){this.goldReceiptForm.reset(),this.customerDues=null}onGoldRateChange(e,t){if(console.log("Gold rate",e.value),console.log("cash",t.value),Number(t.value)>0&&Number(e.value)>0){const o=(Number(t.value)/(Number(e.value)/10)).toFixed(3);this.goldReceiptForm.patchValue({gold_value:o})}else this.goldReceiptForm.patchValue({gold_value:null})}onGoldReceiptSelected(e){this.receiptService.getGoldReceiptDetailsByID(e.gold_receipt_id).subscribe(e=>{this.afterSaveResponse=e.data})}}return e.\u0275fac=function(t){return new(t||e)(a.Y36(s.gz),a.Y36(d.v),a.Y36(c.r),a.Y36(g.V))},e.\u0275cmp=a.Xpm({type:e,selectors:[["app-gold-received"]],decls:36,vars:16,consts:[[1,"d-flex","flex-row"],[1,"p-2","col-4"],[3,"formGroup"],["bindLabel","agent_name","bindValue","agent_id","formControlName","agent_id","placeholder","Select Agent",1,"custom",3,"items","change"],["bindLabel","cust_name","bindValue","cust_id","formControlName","cust_id","placeholder","Select Customer",1,"custom",3,"items","change"],["class","border-glow",4,"ngIf"],["aria-label","Select an option","formControlName","payment_mode",1,"payment-mode"],["value","1",4,"ngIf"],["value","4",4,"ngIf"],["value","5",4,"ngIf"],[4,"ngIf"],[1,"example-full-width"],["type","number","step","0.001","matInput","","formControlName","gold_value","placeholder","Gold Value",1,"text-right",3,"readonly"],[1,"d-flex","flex-row","bd-highlight","mb-3"],[1,"p-2","bd-highlight"],[1,"example-button-row"],["mat-raised-button","","color","accent",1,"text-right",3,"disabled","click"],["mat-raised-button","","color","primary",1,"text-right",3,"disabled","click"],["class","border-glow","id","print-gold-receipt",4,"ngIf"],[1,"p-2","col-8"],[3,"value"],["myTab",""],["pTemplate","header"],["pTemplate","body"],["id","developer-div",4,"ngIf"],[1,"border-glow"],["value","1"],["value","4"],["value","5"],["type","number","matInput","","formControlName","gold_rate","placeholder","Gold Rate",1,"text-right",3,"keyup"],["goldRate",""],["type","number","matInput","","formControlName","cash","placeholder","Cash",1,"text-right",3,"keyup"],["cash",""],["id","print-gold-receipt",1,"border-glow"],["mat-button","","color","primary","printSectionId","print-gold-receipt","styleSheetFile","assets/print_css/gold_receipt/style1.css","ngxPrint","",1,"no-print",3,"useExistingCss"],[2,"padding","5px"],[2,"text-align","right"],["colspan","2",2,"border-top","1px solid black"],[1,"text-right"],[3,"routerLink","click"],["id","developer-div"],[1,"p-2"]],template:function(e,t){1&e&&(a.TgZ(0,"div",0),a.TgZ(1,"div",1),a.TgZ(2,"div"),a.TgZ(3,"form",2),a.TgZ(4,"ng-select",3),a.NdJ("change",function(){return t.agentSelected()}),a.qZA(),a.TgZ(5,"ng-select",4),a.NdJ("change",function(e){return t.onCustomerSelected(e)}),a.qZA(),a.YNc(6,T,15,8,"div",5),a.TgZ(7,"div"),a.TgZ(8,"mat-radio-group",6),a.YNc(9,b,2,0,"mat-radio-button",7),a.YNc(10,x,2,0,"mat-radio-button",8),a.YNc(11,R,2,0,"mat-radio-button",9),a.qZA(),a.qZA(),a.YNc(12,C,13,0,"div",10),a.TgZ(13,"div"),a.TgZ(14,"mat-form-field",11),a.TgZ(15,"mat-label"),a._uU(16,"Enter Gold Received"),a.qZA(),a._UZ(17,"input",12),a.qZA(),a.qZA(),a.TgZ(18,"div",13),a.TgZ(19,"div",14),a.TgZ(20,"div",15),a.TgZ(21,"button",16),a.NdJ("click",function(){return t.resetForm()}),a._uU(22,"Reset"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(23,"div",14),a.TgZ(24,"div",15),a.TgZ(25,"button",17),a.NdJ("click",function(){return t.saveGoldReceipt()}),a._uU(26,"Save Record"),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.YNc(27,w,69,24,"div",18),a.qZA(),a.TgZ(28,"div",19),a.YNc(29,U,2,0,"h3",10),a.YNc(30,y,2,0,"h3",10),a.TgZ(31,"p-table",20,21),a.YNc(33,S,7,0,"ng-template",22),a.YNc(34,I,9,6,"ng-template",23),a.qZA(),a.qZA(),a.qZA(),a.YNc(35,N,16,15,"div",24)),2&e&&(a.xp6(3),a.Q6J("formGroup",t.goldReceiptForm),a.xp6(1),a.Q6J("items",t.agents),a.xp6(1),a.Q6J("items",t.customers),a.xp6(1),a.Q6J("ngIf",t.customerDues),a.xp6(3),a.Q6J("ngIf",t.selectedCustomer&&0==t.selectedCustomer.is_stock_customer),a.xp6(1),a.Q6J("ngIf",t.selectedCustomer&&0==t.selectedCustomer.is_stock_customer),a.xp6(1),a.Q6J("ngIf",t.selectedCustomer&&1==t.selectedCustomer.is_stock_customer),a.xp6(1),a.Q6J("ngIf",t.showCashEntry),a.xp6(5),a.Q6J("readonly",t.showCashEntry),a.xp6(4),a.Q6J("disabled",t.goldReceiptForm.pristine),a.xp6(4),a.Q6J("disabled",!t.goldReceiptForm.valid||t.goldReceiptForm.pristine),a.xp6(2),a.Q6J("ngIf",t.afterSaveResponse),a.xp6(2),a.Q6J("ngIf",t.goldReceipts&&t.goldReceipts.length>0),a.xp6(1),a.Q6J("ngIf",!t.goldReceipts||0==t.goldReceipts.length),a.xp6(1),a.Q6J("value",t.goldReceipts),a.xp6(4),a.Q6J("ngIf",!t.isProduction))},directives:[r._Y,r.JL,r.sg,p.w9,r.JJ,r.u,i.O5,Z.VQ,m.KE,m.hX,r.wV,h.Nt,r.Fj,_.lW,A.iA,q.jx,Z.U0,f.I,v.Hw,s.yS],pipes:[i.JJ,i.Ts],styles:[".payment-mode[_ngcontent-%COMP%]   mat-radio-button[_ngcontent-%COMP%]{margin-left:16px}.border-glow[_ngcontent-%COMP%]{padding:2px;border-color:#28a745;box-shadow:0 0 0 .2rem #28a74540;border-radius:5px;margin-bottom:5px}input[_ngcontent-%COMP%]::-webkit-outer-spin-button, input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}"]}),e})()}];let G=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=a.oAB({type:e}),e.\u0275inj=a.cJS({imports:[[s.Bz.forChild(k)],s.Bz]}),e})(),J=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=a.oAB({type:e}),e.\u0275inj=a.cJS({imports:[[i.ez,G,r.UX,p.A0,m.lN,Z.Fk,v.Ps,f.K,_.ot,h.c,A.U$]]}),e})()}}]);