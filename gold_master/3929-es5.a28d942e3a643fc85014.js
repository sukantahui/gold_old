!function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(i=n.key,r=void 0,"symbol"==typeof(r=function(e,t){if("object"!=typeof e||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"))?r:String(r)),n)}var i,r}function o(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(self.webpackChunkaccounts=self.webpackChunkaccounts||[]).push([[3929],{33929:function(t,n,i){i.r(n),i.d(n,{GoldReceivedModule:function(){return J}});var r=i(38583),a=i(63423),u=i(92340),l=i(3679),c=i(88259),d=i.n(c),s=i(37716),g=i(52541),p=i(82820),m=i(30535),f=i(86640),v=i(82613),Z=i(98295),h=i(49983),b=i(51095),_=i(26584),A=i(33013);function q(e,t){if(1&e&&(s.TgZ(0,"div",23),s.TgZ(1,"span"),s._uU(2),s.ALo(3,"number"),s.qZA(),s._uU(4," and "),s.TgZ(5,"span"),s._uU(6),s.qZA(),s.qZA()),2&e){var o=s.oxw();s.xp6(2),s.hij(" Gold Due: ",s.xi3(3,2,o.customerDues.gold_due,"1.3")," gm. "),s.xp6(4),s.hij(" LC Due: Rs. ",o.customerDues.lc_due,"")}}function T(e,t){if(1&e){var o=s.EpF();s.TgZ(0,"div"),s.TgZ(1,"div"),s.TgZ(2,"mat-form-field",10),s.TgZ(3,"mat-label"),s._uU(4,"Enter Gold Rate(10Gm)"),s.qZA(),s.TgZ(5,"input",24,25),s.NdJ("keyup",function(){s.CHM(o);var e=s.MAs(6),t=s.MAs(12);return s.oxw().onGoldRateChange(e,t)}),s.qZA(),s.qZA(),s.qZA(),s.TgZ(7,"div"),s.TgZ(8,"mat-form-field",10),s.TgZ(9,"mat-label"),s._uU(10,"Enter Cash against Gold"),s.qZA(),s.TgZ(11,"input",26,27),s.NdJ("keyup",function(){s.CHM(o);var e=s.MAs(6),t=s.MAs(12);return s.oxw().onGoldRateChange(e,t)}),s.qZA(),s.qZA(),s.qZA(),s.qZA()}}function R(e,t){1&e&&(s.TgZ(0,"h3"),s._uU(1,"Gold Receipts"),s.qZA())}function y(e,t){1&e&&(s.TgZ(0,"h3"),s._uU(1,"No Receipts recorded"),s.qZA())}function w(e,t){1&e&&(s.TgZ(0,"tr"),s.TgZ(1,"th"),s._uU(2,"Date"),s.qZA(),s.TgZ(3,"th"),s._uU(4,"Receipt No."),s.qZA(),s.TgZ(5,"th"),s._uU(6,"Gold"),s.qZA(),s.qZA())}function x(e,t){if(1&e){var o=s.EpF();s.TgZ(0,"tr"),s.TgZ(1,"td"),s._uU(2),s.qZA(),s.TgZ(3,"td",28),s.TgZ(4,"a",29),s.NdJ("click",function(){var e=s.CHM(o).$implicit;return s.oxw().onLcReceiptSelected(e)}),s._uU(5),s.qZA(),s.qZA(),s.TgZ(6,"td",28),s._uU(7),s.qZA(),s.qZA()}if(2&e){var n=t.$implicit;s.xp6(2),s.hij(" ",n.gold_receipt_date," "),s.xp6(3),s.Oqu(n.gold_receipt_id),s.xp6(2),s.hij(" ",n.gold_value," gm ")}}function N(e,t){if(1&e&&(s.TgZ(0,"div",30),s.TgZ(1,"div",0),s.TgZ(2,"div",31),s.TgZ(3,"pre"),s._uU(4),s.ALo(5,"json"),s.qZA(),s.qZA(),s.TgZ(6,"div",31),s.TgZ(7,"pre"),s._uU(8),s.ALo(9,"json"),s.qZA(),s.qZA(),s.TgZ(10,"div",31),s.TgZ(11,"pre"),s._uU(12),s.ALo(13,"json"),s.qZA(),s.qZA(),s.qZA(),s.qZA()),2&e){var o=s.oxw();s.xp6(4),s.hij("                goldReceiptForm=",s.lcZ(5,3,o.goldReceiptForm.value),"\n            "),s.xp6(4),s.hij("                afterSaveResponse= ",s.lcZ(9,5,o.afterSaveResponse),"\n            "),s.xp6(4),s.hij("                goldReceipts= ",s.lcZ(13,7,o.goldReceipts),"\n            ")}}var C,k=[{path:"",component:(C=function(){function t(o,n,i,a){var c=this;e(this,t),this.route=o,this.customerService=n,this.reportService=i,this.receiptService=a,this.isProduction=u.N.production,this.afterSaveResponse=null,this.selectedCustomer=null,this.showCashEntry=!1,this.route.data.subscribe(function(e){c.agents=e.goldReceiptResolver.agents.data,c.customers=e.goldReceiptResolver.customers.data});var d=new Date,s=(0,r.p6)(d,"yyyy-MM-dd","en");this.goldReceiptForm=new l.cw({gold_receipt_date:new l.NI(s),agent_id:new l.NI(null,[l.kI.required]),cust_id:new l.NI(null,[l.kI.required]),rm_id:new l.NI(36,[l.kI.required]),payment_mode:new l.NI("1",[l.kI.required]),gold_value:new l.NI(null,[l.kI.required,l.kI.min(.001)]),discount:new l.NI(0),gold_rate:new l.NI(6e4),cash:new l.NI(0),last_gold_balance:new l.NI(0,[l.kI.required]),current_lc_balance:new l.NI(0,[l.kI.required])})}return o(t,[{key:"ngOnInit",value:function(){this.onPaymentModeValueChanged()}},{key:"agentSelected",value:function(){}},{key:"onCustomerSelected",value:function(e){var t=this;this.selectedCustomer=e.cust_id,this.afterSaveResponse=null,this.customerService.getCustomerDues(e.cust_id).subscribe(function(e){console.log("value changed",e.data),t.customerDues=e.data,t.goldReceiptForm.patchValue({last_gold_balance:t.customerDues.gold_due,current_lc_balance:t.customerDues.lc_due})}),this.receiptService.getGoldReceiptsByCustomer(this.selectedCustomer).subscribe(function(e){t.goldReceipts=e.data})}},{key:"saveGoldReceipt",value:function(){var e=this;this.receiptService.saveGoldReceipt(this.goldReceiptForm.value).subscribe(function(t){!0===t.status&&(d().fire({title:"Done",text:"Gold Received added successfully",icon:"success"}),e.customerDues.lc_due=e.customerDues.lc_due-e.goldReceiptForm.value.amount,e.afterSaveResponse=t.data,e.goldReceiptForm.markAsPristine(),e.goldReceipts.unshift(e.afterSaveResponse.gold_receipt))},function(e){d().fire({title:"Done",text:"Error saving Gold Receipt",icon:"error"})})}},{key:"resetForm",value:function(){this.goldReceiptForm.reset(),this.customerDues=null}},{key:"onLcReceiptSelected",value:function(e){}},{key:"onGoldRateChange",value:function(e,t){if(console.log("Gold rate",e.value),console.log("cash",t.value),Number(t.value)>0&&Number(e.value)>0){var o=(Number(t.value)/(Number(e.value)/10)).toFixed(3);this.goldReceiptForm.patchValue({gold_value:o})}else this.goldReceiptForm.patchValue({gold_value:null})}},{key:"onPaymentModeValueChanged",value:function(){var e=this;this.goldReceiptForm.get("payment_mode").valueChanges.subscribe(function(t){e.showCashEntry="2"===t})}}]),t}(),C.\u0275fac=function(e){return new(e||C)(s.Y36(a.gz),s.Y36(g.v),s.Y36(p.r),s.Y36(m.V))},C.\u0275cmp=s.Xpm({type:C,selectors:[["app-gold-received"]],decls:35,vars:10,consts:[[1,"d-flex","flex-row"],[1,"p-2","col-4"],[3,"formGroup"],["bindLabel","agent_name","bindValue","agent_id","formControlName","agent_id","placeholder","Select Agent",1,"custom",3,"items","change"],["bindLabel","cust_name","bindValue","cust_id","formControlName","cust_id","placeholder","Select Customer",1,"custom",3,"items","change"],["class","border-glow",4,"ngIf"],["aria-label","Select an option","formControlName","payment_mode",1,"payment-mode"],["value","1"],["value","2"],[4,"ngIf"],[1,"example-full-width"],["type","number","step","0.001","matInput","","formControlName","gold_value","placeholder","Gold Value",1,"text-right"],[1,"d-flex","flex-row","bd-highlight","mb-3"],[1,"p-2","bd-highlight"],[1,"example-button-row"],["mat-button","","color","primary",1,"text-right",3,"click"],["mat-button","","color","primary",1,"text-right",3,"disabled","click"],[1,"p-2","col-8"],[3,"value"],["myTab",""],["pTemplate","header"],["pTemplate","body"],["id","developer-div",4,"ngIf"],[1,"border-glow"],["type","number","matInput","","formControlName","gold_rate","placeholder","Gold Rate",1,"text-right",3,"keyup"],["goldRate",""],["type","number","matInput","","formControlName","cash","placeholder","Cash",1,"text-right",3,"keyup"],["cash",""],[1,"text-right"],[3,"routerLink","click"],["id","developer-div"],[1,"p-2"]],template:function(e,t){1&e&&(s.TgZ(0,"div",0),s.TgZ(1,"div",1),s.TgZ(2,"form",2),s.TgZ(3,"ng-select",3),s.NdJ("change",function(){return t.agentSelected()}),s.qZA(),s.TgZ(4,"ng-select",4),s.NdJ("change",function(e){return t.onCustomerSelected(e)}),s.qZA(),s.YNc(5,q,7,5,"div",5),s.TgZ(6,"div"),s.TgZ(7,"mat-radio-group",6),s.TgZ(8,"mat-radio-button",7),s._uU(9,"In Gold"),s.qZA(),s.TgZ(10,"mat-radio-button",8),s._uU(11,"In Cash"),s.qZA(),s.qZA(),s.qZA(),s.YNc(12,T,13,0,"div",9),s.TgZ(13,"div"),s.TgZ(14,"mat-form-field",10),s.TgZ(15,"mat-label"),s._uU(16,"Enter Gold Received"),s.qZA(),s._UZ(17,"input",11),s.qZA(),s.qZA(),s.TgZ(18,"div",12),s.TgZ(19,"div",13),s.TgZ(20,"div",14),s.TgZ(21,"button",15),s.NdJ("click",function(){return t.resetForm()}),s._uU(22,"Reset"),s.qZA(),s.qZA(),s.qZA(),s.TgZ(23,"div",13),s.TgZ(24,"div",14),s.TgZ(25,"button",16),s.NdJ("click",function(){return t.saveGoldReceipt()}),s._uU(26,"Save Record"),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.TgZ(27,"div",17),s.YNc(28,R,2,0,"h3",9),s.YNc(29,y,2,0,"h3",9),s.TgZ(30,"p-table",18,19),s.YNc(32,w,7,0,"ng-template",20),s.YNc(33,x,8,3,"ng-template",21),s.qZA(),s.qZA(),s.qZA(),s.YNc(34,N,14,9,"div",22)),2&e&&(s.xp6(2),s.Q6J("formGroup",t.goldReceiptForm),s.xp6(1),s.Q6J("items",t.agents),s.xp6(1),s.Q6J("items",t.customers),s.xp6(1),s.Q6J("ngIf",t.customerDues),s.xp6(7),s.Q6J("ngIf",t.showCashEntry),s.xp6(13),s.Q6J("disabled",!t.goldReceiptForm.valid||t.goldReceiptForm.pristine),s.xp6(3),s.Q6J("ngIf",t.goldReceipts&&t.goldReceipts.length>0),s.xp6(1),s.Q6J("ngIf",!t.goldReceipts||0==t.goldReceipts.length),s.xp6(1),s.Q6J("value",t.goldReceipts),s.xp6(4),s.Q6J("ngIf",!t.isProduction))},directives:[l._Y,l.JL,l.sg,f.w9,l.JJ,l.u,r.O5,v.VQ,v.U0,Z.KE,Z.hX,l.wV,h.Nt,l.Fj,b.lW,_.iA,A.jx,a.yS],pipes:[r.JJ,r.Ts],styles:[".payment-mode[_ngcontent-%COMP%]   mat-radio-button[_ngcontent-%COMP%]{margin-left:16px}.border-glow[_ngcontent-%COMP%]{padding:2px;border-color:#28a745;box-shadow:0 0 0 .2rem #28a74540;border-radius:5px;margin-bottom:5px}input[_ngcontent-%COMP%]::-webkit-outer-spin-button, input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}"]}),C)}],I=function(){var t=o(function t(){e(this,t)});return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=s.oAB({type:t}),t.\u0275inj=s.cJS({imports:[[a.Bz.forChild(k)],a.Bz]}),t}(),S=i(76627),U=i(95913),J=function(){var t=o(function t(){e(this,t)});return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=s.oAB({type:t}),t.\u0275inj=s.cJS({imports:[[r.ez,I,l.UX,f.A0,Z.lN,v.Fk,S.Ps,U.K,b.ot,h.c,_.U$]]}),t}()}}])}();