"use strict";(self.webpackChunkaccounts=self.webpackChunkaccounts||[]).push([[5159],{65159:function(e,t,r){r.r(t),r.d(t,{OrderModule:function(){return be}});var o=r(38583),i=r(63423),s=r(3679),a=r(49976),n=r(88259),l=r.n(n),c=r(92340),d=r(37716),u=r(5620),g=r(37825),h=r(91841),p=r(66082),m=r(79765),f=r(84889);let Z=(()=>{class e{constructor(e,t,r){this.commonService=e,this.http=t,this.errorService=r,this.customerCategorySub=new m.xQ,this.http.get(this.commonService.getAPI()+"/dev/customerCategories/visible").subscribe(e=>{this.customerCategoryList=e.data,this.customerCategorySub.next([...this.customerCategoryList])})}getCategories(){return this.customerCategoryList}getCustomerCategoryUpdateListener(){return this.customerCategorySub.asObservable()}}return e.\u0275fac=function(t){return new(t||e)(d.LFG(u.v),d.LFG(h.eN),d.LFG(f.T))},e.\u0275prov=d.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var _=r(80226),v=r(22759),x=r(98085),y=r(40205),b=r(25917),q=r(67574),A=r(33637),T=r(94402),S=r(19773),w=r(88002),I=r(28049),D=r(96736),F=r(70409),O=r(68307),M=r(59746),U=r(5304);let C=(()=>{class e{validate(e,t){switch(t.type){case"string":return this.validateString(e,t);case"number":case"integer":return this.validateNumber(e,t);case"boolean":return this.validateBoolean(e,t);case"array":return this.validateArray(e,t);case"object":return this.validateObject(e,t)}}validateString(e,t){if("string"!=typeof e||!this.validateConst(e,t)||!this.validateEnum(e,t)||void 0!==t.maxLength&&e.length>t.maxLength||void 0!==t.minLength&&e.length<t.minLength)return!1;if(t.pattern){let o=null;try{o=new RegExp(t.pattern)}catch(r){}if(o&&!o.test(e))return!1}return!0}validateNumber(e,t){return!("number"!=typeof e||"integer"===t.type&&!Number.isInteger(e)||!this.validateConst(e,t)||!this.validateEnum(e,t)||t.multipleOf&&!Number.isInteger(e/t.multipleOf)||void 0!==t.maximum&&e>t.maximum||void 0!==t.exclusiveMaximum&&e>=t.exclusiveMaximum||void 0!==t.minimum&&e<t.minimum||void 0!==t.exclusiveMinimum&&e<=t.exclusiveMinimum)}validateBoolean(e,t){return!("boolean"!=typeof e||!this.validateConst(e,t))}validateArray(e,t){if(!Array.isArray(e)||void 0!==t.maxItems&&e.length>t.maxItems||void 0!==t.minItems&&e.length<t.minItems)return!1;if(t.uniqueItems){const t=new Set(e);if(e.length!==t.size)return!1}if(Array.isArray(t.items))return this.validateTuple(e,t.items);for(const r of e)if(!this.validate(r,t.items))return!1;return!0}validateTuple(e,t){if(e.length!==t.length)return!1;for(let r=0;r<t.length;r+=1)if(!this.validate(e[r],t[r]))return!1;return!0}validateObject(e,t){if("object"!=typeof e||null===e||Object.keys(t.properties).length<Object.keys(e).length)return!1;if(t.required)for(const r of t.required)if(!Object.prototype.hasOwnProperty.call(e,r))return!1;for(const r in t.properties)if(Object.prototype.hasOwnProperty.call(t.properties,r)&&Object.prototype.hasOwnProperty.call(e,r)&&!this.validate(e[r],t.properties[r]))return!1;return!0}validateConst(e,t){return!t.const||e===t.const}validateEnum(e,t){return!t.enum||t.enum.includes(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=d.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const L=new d.OlP("localStoragePrefix",{providedIn:"root",factory:()=>""}),k="ngStorage",N=new d.OlP("localStorageIDBDBName",{providedIn:"root",factory:()=>k}),P=new d.OlP("localStorageIDBDBVersion",{providedIn:"root",factory:()=>1}),z="localStorage",B=new d.OlP("localStorageIDBStoreName",{providedIn:"root",factory:()=>z}),V=new d.OlP("localStorageIDBWrap",{providedIn:"root",factory:()=>!0}),J="indexedDB is not working";class Q extends Error{constructor(){super(...arguments),this.message=J}}class G extends Error{constructor(){super(...arguments),this.message="The storage is currently localStorage,\nwhere data must be serialized, and the provided data can't be serialized."}}let Y=(()=>{class e{constructor(e=k,t=z,r=1,o=!0){this.database=new _.t(1),this.wrapIndex="value",this.dbName=e,this.storeName=t,this.dbVersion=r,this.noWrap=o,this.connect()}get backingStore(){return{database:this.dbName,store:this.storeName,version:this.dbVersion}}get size(){return this.transaction("readonly").pipe((0,S.zg)(e=>{const{store:t,events:r}=e,o=t.count();return r.pipe((0,w.U)(()=>o.result))}),(0,I.P)())}get(e){return this.transaction("readonly").pipe((0,S.zg)(t=>{const{store:r,events:o}=t,i=r.get(e);return o.pipe((0,w.U)(()=>{if(null!=i.result)return!this.noWrap&&"object"==typeof i.result&&this.wrapIndex in i.result&&null!=i.result[this.wrapIndex]?i.result[this.wrapIndex]:i.result}))}),(0,I.P)())}set(e,t){return void 0===t?this.delete(e):this.transaction("readwrite").pipe((0,S.zg)(r=>{const{store:o,events:i}=r;return o.put(this.noWrap?t:{[this.wrapIndex]:t},e),i.pipe((0,D.h)(void 0))}),(0,I.P)())}delete(e){return this.transaction("readwrite").pipe((0,S.zg)(t=>{const{store:r,events:o}=t;return r.delete(e),o.pipe((0,D.h)(void 0))}),(0,I.P)())}clear(){return this.transaction("readwrite").pipe((0,S.zg)(e=>{const{store:t,events:r}=e;return t.clear(),r.pipe((0,D.h)(void 0))}),(0,I.P)())}keys(){return this.transaction("readonly").pipe((0,I.P)(),(0,S.zg)(e=>{const{store:t}=e,r="openKeyCursor"in t?t.openKeyCursor():t.openCursor(),o=(0,v.R)(r,"success").pipe((0,F.o)(()=>null!==r.result),(0,w.U)(()=>r.result.key.toString()),(0,O.b)(()=>{r.result.continue()})),i=this.listenError(r);return(0,x.S3)([o,i])}))}has(e){return this.transaction("readonly").pipe((0,S.zg)(t=>{const{store:r,events:o}=t,i="getKey"in r?r.getKey(e):r.get(e);return o.pipe((0,w.U)(()=>void 0!==i.result))}),(0,I.P)())}connect(){let e;try{e=indexedDB.open(this.dbName,this.dbVersion)}catch(o){return void this.database.error(new Q)}this.createStore(e);const t=(0,v.R)(e,"success"),r=this.listenError(e);(0,x.S3)([t,r]).pipe((0,I.P)()).subscribe({next:()=>{this.database.next(e.result)},error:()=>{this.database.error(new Q)}})}createStore(e){(0,v.R)(e,"upgradeneeded").pipe((0,I.P)()).subscribe({next:()=>{e.result.objectStoreNames.contains(this.storeName)||e.result.createObjectStore(this.storeName)}})}transaction(e){return this.database.pipe((0,S.zg)(t=>{let r;try{r=t.transaction([this.storeName],e)}catch(s){return(0,y._)(s)}const o=r.objectStore(this.storeName),i=this.listenTransactionEvents(r);return(0,b.of)({store:o,events:i})}))}listenError(e){return(0,v.R)(e,"error").pipe((0,S.zg)(e=>(0,y._)(e.target.error)))}listenTransactionEvents(e){const t=(0,v.R)(e,"complete"),r=this.listenError(e);return(0,x.S3)([t,r])}}return e.\u0275fac=function(t){return new(t||e)(d.LFG(N),d.LFG(B),d.LFG(P),d.LFG(V))},e.\u0275prov=d.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),j=(()=>{class e{constructor(e=""){this.prefix=e||""}get size(){return(0,b.of)(localStorage.length)}get(e){const t=localStorage.getItem(this.prefixKey(e));let r;if(null!=t)try{r=JSON.parse(t)}catch(o){return(0,y._)(o)}return(0,b.of)(r)}set(e,t){let r=null;const o=Object.getPrototypeOf(t);if("object"==typeof t&&null!==t&&!Array.isArray(t)&&o!==Object.prototype&&null!==o)return(0,y._)(new G);try{r=JSON.stringify(t)}catch(i){return(0,y._)(i)}try{localStorage.setItem(this.prefixKey(e),r)}catch(i){return(0,y._)(i)}return(0,b.of)(void 0)}delete(e){return localStorage.removeItem(this.prefixKey(e)),(0,b.of)(void 0)}clear(){return localStorage.clear(),(0,b.of)(void 0)}keys(){return new q.y(e=>{for(let t=0;t<localStorage.length;t+=1)e.next(this.getUnprefixedKey(t));e.complete()}).pipe((0,M.QV)(A.z))}has(e){for(let t=0;t<localStorage.length;t+=1)if(e===this.getUnprefixedKey(t))return(0,b.of)(!0);return(0,b.of)(!1)}getUnprefixedKey(e){const t=localStorage.key(e);return null!==t?this.prefix?t.substr(this.prefix.length):t:null}prefixKey(e){return`${this.prefix}${e}`}}return e.\u0275fac=function(t){return new(t||e)(d.LFG(L))},e.\u0275prov=d.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),E=(()=>{class e{constructor(){this.memoryStorage=new Map}get size(){return(0,b.of)(this.memoryStorage.size)}get(e){return(0,b.of)(this.memoryStorage.get(e))}set(e,t){return this.memoryStorage.set(e,t),(0,b.of)(void 0)}delete(e){return this.memoryStorage.delete(e),(0,b.of)(void 0)}clear(){return this.memoryStorage.clear(),(0,b.of)(void 0)}keys(){return(0,T.D)(this.memoryStorage.keys())}has(e){return(0,b.of)(this.memoryStorage.has(e))}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=d.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),K=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=d.Yz7({token:e,factory:function(e){let t=null;return t=e?new e:function(e,t,r,i,s,a){try{if((0,o.NF)(e)&&void 0!==indexedDB&&null!==indexedDB&&"open"in indexedDB)return new Y(r,i,s,a);if((0,o.NF)(e)&&void 0!==localStorage&&null!==localStorage&&"getItem"in localStorage)return new j(t)}catch(n){}return new E}(d.LFG(d.Lbi),d.LFG(L),d.LFG(N),d.LFG(B),d.LFG(P),d.LFG(V)),t},providedIn:"root"}),e})();class H extends Error{constructor(){super(...arguments),this.message="Data stored is not valid against the provided JSON schema.\nCheck your JSON schema, otherwise it means data has been corrupted."}}let R=(()=>{class e{constructor(e,t=new C,r=""){this.database=e,this.jsonValidator=t,this.LSPrefix=r,this.notifiers=new Map}get size(){return this.database.size.pipe(this.catchIDBBroken(()=>this.database.size))}get backingEngine(){return this.database instanceof Y?"indexedDB":this.database instanceof j?"localStorage":this.database instanceof E?"memory":"unknown"}get backingStore(){return this.database instanceof Y?this.database.backingStore:{database:"",store:"",version:0}}get fallbackBackingStore(){return this.database instanceof j?{prefix:this.database.prefix}:{prefix:""}}get(e,t){return this.database.get(e).pipe(this.catchIDBBroken(()=>this.database.get(e)),(0,S.zg)(e=>null==e?(0,b.of)(void 0):t?this.jsonValidator.validate(e,t)?(0,b.of)(e):(0,y._)(new H):(0,b.of)(e)))}set(e,t,r){return null==t?this.delete(e):r&&!this.jsonValidator.validate(t,r)?(0,y._)(new H):this.database.set(e,t).pipe(this.catchIDBBroken(()=>this.database.set(e,t)),(0,O.b)(()=>{this.notify(e,t)}))}delete(e){return this.database.delete(e).pipe(this.catchIDBBroken(()=>this.database.delete(e)),(0,O.b)(()=>{this.notify(e,void 0)}))}clear(){return this.database.clear().pipe(this.catchIDBBroken(()=>this.database.clear()),(0,O.b)(()=>{for(const e of this.notifiers.keys())this.notify(e,void 0)}))}keys(){return this.database.keys().pipe(this.catchIDBBroken(()=>this.database.keys()))}has(e){return this.database.has(e).pipe(this.catchIDBBroken(()=>this.database.has(e)))}watch(e,t){this.notifiers.has(e)||this.notifiers.set(e,new _.t(1));const r=this.notifiers.get(e);return(t?this.get(e,t):this.get(e)).subscribe({next:e=>r.next(e),error:e=>r.error(e)}),r.asObservable()}notify(e,t){const r=this.notifiers.get(e);r&&r.next(t)}catchIDBBroken(e){return(0,U.K)(t=>{if(null!=t&&"object"==typeof t&&"message"in t&&t.message===J){try{this.database="getItem"in localStorage?new j(this.LSPrefix):new E}catch(r){this.database=new E}return e()}return(0,y._)(t)})}}return e.\u0275fac=function(t){return new(t||e)(d.LFG(K),d.LFG(C),d.LFG(L))},e.\u0275prov=d.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),W=(()=>{class e{constructor(e,t,r){this.commonService=e,this.http=t,this.errorService=r}saveOrder(e,t){return this.http.post(this.commonService.getAPI()+"/save",{orderMaster:e,orderDetails:t})}getOrderMasterList(e){return this.http.get(this.commonService.getAPI()+"/dev/getOrderMasterList/"+e)}getOrderDetailsByOrderMaster(e){return this.http.get(this.commonService.getAPI()+"/orderDetails/orderMasterId/"+e)}}return e.\u0275fac=function(t){return new(t||e)(d.LFG(u.v),d.LFG(h.eN),d.LFG(f.T))},e.\u0275prov=d.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var $=r(35618),X=r(93738),ee=r(86640),te=r(98295),re=r(49983),oe=r(51095),ie=r(70346),se=r(95913),ae=r(76627),ne=r(39577);function le(e,t){if(1&e&&d._UZ(0,"span",35),2&e){const e=d.oxw();d.Q6J("matBadge",e.selectedProduct.price_code)}}function ce(e,t){if(1&e&&(d.ynx(0),d.TgZ(1,"th",43),d._uU(2),d.qZA(),d.TgZ(3,"th",43),d._uU(4),d.qZA(),d.TgZ(5,"th",41),d._uU(6),d.qZA(),d.TgZ(7,"th",44),d._uU(8),d.qZA(),d.TgZ(9,"th",44),d._uU(10),d.ALo(11,"number"),d.qZA(),d.BQk()),2&e){const e=d.oxw(),t=e.index,r=e.$implicit;d.xp6(2),d.Oqu(t+1),d.xp6(2),d.AsE("",r.product_code,"-",r.price_code,""),d.xp6(2),d.Oqu(r.prd_size),d.xp6(2),d.Oqu(r.qty),d.xp6(2),d.Oqu(d.xi3(11,6,r.gold_wt,"1.3"))}}function de(e,t){1&e&&(d.TgZ(0,"tr"),d.YNc(1,ce,12,9,"ng-container",26),d.qZA()),2&e&&(d.xp6(1),d.Q6J("ngIf",!0))}function ue(e,t){if(1&e&&(d.TgZ(0,"mat-card"),d.TgZ(1,"div",36),d.TgZ(2,"button",37),d.TgZ(3,"mat-icon"),d._uU(4,"print"),d.qZA(),d.qZA(),d.qZA(),d.TgZ(5,"div",38),d.TgZ(6,"table",39),d.TgZ(7,"thead"),d.TgZ(8,"tr"),d.TgZ(9,"th"),d._uU(10,"Customer"),d.qZA(),d.TgZ(11,"td",40),d._uU(12),d.qZA(),d.qZA(),d.TgZ(13,"tr"),d.TgZ(14,"th"),d._uU(15,"Order ID"),d.qZA(),d.TgZ(16,"td",40),d._uU(17),d.qZA(),d.qZA(),d.TgZ(18,"tr"),d.TgZ(19,"th"),d._uU(20,"Order Date"),d.qZA(),d.TgZ(21,"td",40),d._uU(22),d.ALo(23,"date"),d.qZA(),d.qZA(),d.qZA(),d.TgZ(24,"tbody"),d.TgZ(25,"tr"),d.TgZ(26,"th",41),d._uU(27,"SL"),d.qZA(),d.TgZ(28,"th",41),d._uU(29,"Product Code"),d.qZA(),d.TgZ(30,"th",41),d._uU(31,"Size"),d.qZA(),d.TgZ(32,"th",41),d._uU(33,"Qty"),d.qZA(),d.TgZ(34,"th",41),d._uU(35,"Gold Weight"),d.qZA(),d.qZA(),d.YNc(36,de,2,1,"tr",42),d.qZA(),d.qZA(),d.qZA(),d.qZA()),2&e){const e=d.oxw();d.xp6(2),d.Q6J("printStyle",e.printDivStyle),d.xp6(10),d.Oqu(e.printAbleOrderDetails.customer.cust_name),d.xp6(5),d.Oqu(e.printAbleOrderDetails.order_master.order_id),d.xp6(5),d.Oqu(d.xi3(23,5,e.printAbleOrderDetails.order_master.order_date,"dd/MM/y")),d.xp6(14),d.Q6J("ngForOf",e.printAbleOrderDetails.order_details)}}function ge(e,t){if(1&e){const e=d.EpF();d.ynx(0),d.TgZ(1,"th",43),d._uU(2),d.qZA(),d.TgZ(3,"td",49),d._uU(4),d.qZA(),d.TgZ(5,"td",49),d._uU(6),d.qZA(),d.TgZ(7,"td",44),d._uU(8),d.qZA(),d.TgZ(9,"td",44),d._uU(10),d.ALo(11,"number"),d.qZA(),d.TgZ(12,"td",44),d._uU(13),d.qZA(),d.TgZ(14,"td",44),d._uU(15),d.qZA(),d.TgZ(16,"td",44),d._uU(17),d.qZA(),d.TgZ(18,"td",44),d._uU(19),d.ALo(20,"number"),d.qZA(),d.TgZ(21,"td",44),d._uU(22),d.ALo(23,"number"),d.qZA(),d.TgZ(24,"td",44),d._uU(25),d.ALo(26,"number"),d.qZA(),d.TgZ(27,"td",44),d.TgZ(28,"a",50),d.NdJ("click",function(){d.CHM(e);const t=d.oxw(),r=t.$implicit,o=t.index;return d.oxw(2).populateOrderFormDetails(r,o)}),d._UZ(29,"fa-icon",46),d.qZA(),d.qZA(),d.TgZ(30,"td",44),d.TgZ(31,"a",50),d.NdJ("click",function(){d.CHM(e);const t=d.oxw().index;return d.oxw(2).deleteItem(t)}),d._UZ(32,"fa-icon",46),d.qZA(),d.qZA(),d.BQk()}if(2&e){const e=d.oxw(),t=e.index,r=e.$implicit,o=d.oxw(2);d.xp6(2),d.Oqu(t+1),d.xp6(2),d.AsE("",r.product_code,"-",r.price_code,""),d.xp6(2),d.Oqu(r.product_size),d.xp6(2),d.Oqu(r.qty),d.xp6(2),d.Oqu(d.xi3(11,14,r.expected_gold,"1.3")),d.xp6(3),d.Oqu(r.cust_category.category),d.xp6(2),d.Oqu(r.ploss),d.xp6(2),d.Oqu(r.lc),d.xp6(2),d.Oqu(d.xi3(20,17,r.product_mv,"1.3")),d.xp6(3),d.Oqu(d.xi3(23,20,r.cust_mv,"1.3")),d.xp6(3),d.Oqu(d.xi3(26,23,r.product_mv+r.cust_mv,"1.3")),d.xp6(4),d.Q6J("icon",o.faPencilAlt),d.xp6(3),d.Q6J("icon",o.faTrashAlt)}}function he(e,t){1&e&&(d.TgZ(0,"tr"),d.YNc(1,ge,33,26,"ng-container",26),d.qZA()),2&e&&(d.xp6(1),d.Q6J("ngIf",!0))}function pe(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"div"),d.TgZ(1,"table",39),d.TgZ(2,"thead"),d.TgZ(3,"tr"),d.TgZ(4,"th",41),d._uU(5,"SL"),d.qZA(),d.TgZ(6,"th",41),d._uU(7,"Model"),d.qZA(),d.TgZ(8,"th",41),d._uU(9,"Size"),d.qZA(),d.TgZ(10,"th",41),d._uU(11,"Qty"),d.qZA(),d.TgZ(12,"th",41),d._uU(13,"Exp. Gold"),d.qZA(),d.TgZ(14,"th",41),d._uU(15,"Plan"),d.qZA(),d.TgZ(16,"th",41),d._uU(17,"Ploss"),d.qZA(),d.TgZ(18,"th",41),d._uU(19,"LC"),d.qZA(),d.TgZ(20,"th",41),d._uU(21,"PR. MV"),d.qZA(),d.TgZ(22,"th",41),d._uU(23,"CMV"),d.qZA(),d.TgZ(24,"th",41),d._uU(25,"TMV"),d.qZA(),d.TgZ(26,"th",45),d._UZ(27,"fa-icon",46),d.qZA(),d.qZA(),d.qZA(),d.TgZ(28,"tbody"),d.YNc(29,he,2,1,"tr",42),d.qZA(),d._UZ(30,"tfoot"),d.qZA(),d.TgZ(31,"div",47),d.TgZ(32,"div",48),d.TgZ(33,"button",33),d.NdJ("click",function(){return d.CHM(e),d.oxw().clearOrder()}),d._uU(34,"Clear"),d.qZA(),d.qZA(),d.TgZ(35,"div",48),d.TgZ(36,"button",33),d.NdJ("click",function(){return d.CHM(e),d.oxw().saveOrder()}),d._uU(37,"Save"),d.qZA(),d.qZA(),d.qZA(),d.qZA()}if(2&e){const e=d.oxw();d.xp6(27),d.Q6J("icon",e.faCogs),d.xp6(2),d.Q6J("ngForOf",e.orderDetails)}}function me(e,t){if(1&e){const e=d.EpF();d.ynx(0),d.TgZ(1,"th",43),d._uU(2),d.qZA(),d.TgZ(3,"th",43),d._uU(4),d.qZA(),d.TgZ(5,"td",49),d._uU(6),d.qZA(),d.TgZ(7,"td",44),d._uU(8),d.ALo(9,"date"),d.qZA(),d.TgZ(10,"td",41),d.TgZ(11,"button",51),d.NdJ("click",function(){d.CHM(e);const t=d.oxw().$implicit;return d.oxw(2).viewOrderDetailsByOrderMaster(t.order_autoid)}),d._UZ(12,"i",52),d.qZA(),d.qZA(),d.BQk()}if(2&e){const e=d.oxw(),t=e.index,r=e.$implicit;d.xp6(2),d.Oqu(t+1),d.xp6(2),d.Oqu(r.cust_name),d.xp6(2),d.Oqu(r.order_id),d.xp6(2),d.Oqu(d.xi3(9,4,r.order_date,"dd-MM-yyyy"))}}function fe(e,t){1&e&&(d.TgZ(0,"tr"),d.YNc(1,me,13,7,"ng-container",26),d.qZA()),2&e&&(d.xp6(1),d.Q6J("ngIf",!0))}function Ze(e,t){if(1&e&&(d.TgZ(0,"mat-card"),d.TgZ(1,"table",39),d.TgZ(2,"thead"),d.TgZ(3,"tr"),d.TgZ(4,"th",41),d._uU(5,"SL"),d.qZA(),d.TgZ(6,"th",41),d._uU(7,"Name"),d.qZA(),d.TgZ(8,"th",41),d._uU(9,"Order Id"),d.qZA(),d.TgZ(10,"th",41),d._uU(11,"Order Date"),d.qZA(),d.TgZ(12,"td"),d._uU(13,"View Details"),d.qZA(),d.qZA(),d.qZA(),d.TgZ(14,"tbody"),d.YNc(15,fe,2,1,"tr",42),d.qZA(),d._UZ(16,"tfoot"),d.qZA(),d.qZA()),2&e){const e=d.oxw();d.xp6(15),d.Q6J("ngForOf",e.orderMasterList)}}function _e(e,t){if(1&e&&(d.TgZ(0,"div",53),d.TgZ(1,"div",54),d.TgZ(2,"div",55),d.TgZ(3,"div",56),d.TgZ(4,"pre"),d._uU(5),d.ALo(6,"json"),d.qZA(),d.qZA(),d.TgZ(7,"div",57),d.TgZ(8,"pre"),d._uU(9),d.ALo(10,"json"),d.qZA(),d.qZA(),d.TgZ(11,"div",56),d._uU(12,"3"),d.qZA(),d.TgZ(13,"div",56),d._uU(14,"4"),d.qZA(),d.qZA(),d.qZA(),d.qZA()),2&e){const e=d.oxw();d.xp6(5),d.hij("                    this.orderDetails = ",d.lcZ(6,2,e.orderFormDetails.value),"\n                "),d.xp6(4),d.hij("                    orderDetails = ",d.lcZ(10,4,e.orderDetails),"\n                ")}}const ve=[{path:"",component:(()=>{class e{constructor(e,t,r,i,n,l,d){this.commonService=e,this.agentService=t,this.http=r,this.productService=i,this.customerCategoryService=n,this.storage=l,this.orderService=d,this.orderDetails=[],this.orderMasterList=[],this.viewDetails=!1,this.orderMasterListOfDetails=[],this.faUserEdit=a.yXf,this.faTrashAlt=a.I7k,this.faPencilAlt=a.UJf,this.faCogs=a.Kb6,this.faPrint=a.wf8,this.faCheck=a.LEp,this.isProduction=c.N.production,this.printDivStyle={table:{"border-collapse":"collapse",width:"100%"},label:{width:"100%"},th:{border:"1px  solid black",fontSize:"small"},td:{border:"1px  solid black",fontSize:"small"}},this.pageSize=50,this.agents=this.agentService.getAgents(),this.products=this.productService.getProducts(),this.customerCategories=this.customerCategoryService.getCategories();const u=new Date,g=(0,o.p6)(u,"yyyy-MM-dd","en");this.orderFormMaster=new s.cw({order_date:new s.NI(g),delivery_date:new s.NI(g),agent_id:new s.NI(null,[s.kI.required]),cust_id:new s.NI(null,[s.kI.required]),cust_mv:new s.NI(null,[s.kI.required]),lc_discount_percentage:new s.NI(null,[s.kI.required])}),this.orderFormDetails=new s.cw({product_code:new s.NI(null,[s.kI.required]),customer_category_id:new s.NI(null,[s.kI.required]),lc:new s.NI(null,[s.kI.required]),ploss:new s.NI(null,[s.kI.required]),product_mv:new s.NI(null,[s.kI.required]),qty:new s.NI(null,[s.kI.required]),expected_gold:new s.NI(null,[s.kI.required]),rm_id:new s.NI(48,[s.kI.required]),product_size:new s.NI(null,[s.kI.required])})}ngOnInit(){this.agentService.getAgentUpdateListener().subscribe(e=>{this.agents=e}),this.productService.getProductUpdateListener().subscribe(e=>{this.products=e}),this.customerCategoryService.getCustomerCategoryUpdateListener().subscribe(e=>{this.customerCategories=e}),this.storage.get("orderDetails").subscribe(e=>{this.orderDetails=e||[]},e=>{console.log(e)}),this.storage.get("orderMaster").subscribe(e=>{e&&(this.orderFormMaster.get("agent_id").patchValue(e.agent_id,{onlySelf:!0}),this.agentSelected(),this.orderFormMaster.get("cust_id").patchValue(e.cust_id,{onlySelf:!0}),this.orderMaster={cust_id:this.orderFormMaster.get("cust_id").value,agent_id:this.orderFormMaster.get("agent_id").value,cust_mv:this.orderFormMaster.get("cust_mv").value,order_date:this.orderFormMaster.get("order_date").value,delivery_date:this.orderFormMaster.get("delivery_date").value,lc_discount_percentage:this.orderFormMaster.get("lc_discount_percentage").value})})}agentSelected(){this.orderFormMaster.get("agent_id"),this.orderFormMaster.get("cust_id").patchValue(null,{onlySelf:!0}),this.orderFormMaster.get("cust_mv").patchValue(null,{onlySelf:!0}),this.http.get(this.commonService.getAPI()+"/dev/customersInforced").subscribe(e=>{this.customers=e.data})}customerSelected(e){this.selectedCustomer=e,this.orderFormMaster.get("cust_mv").patchValue(this.selectedCustomer.markup_value,{onlySelf:!0}),this.orderFormMaster.get("lc_discount_percentage").patchValue(this.selectedCustomer.lc_discount_percentage,{onlySelf:!0}),this.orderMaster={cust_id:this.orderFormMaster.get("cust_id").value,agent_id:this.orderFormMaster.get("agent_id").value,cust_mv:this.orderFormMaster.get("cust_mv").value,order_date:this.orderFormMaster.get("order_date").value,delivery_date:this.orderFormMaster.get("delivery_date").value,lc_discount_percentage:this.orderFormMaster.get("lc_discount_percentage").value},this.storage.set("orderMaster",this.orderMaster).subscribe(()=>{})}productSelected(e){this.selectedProduct=e,this.orderFormDetails.get("customer_category_id").patchValue(null,{onlySelf:!0}),this.orderFormDetails.get("lc").patchValue(null,{onlySelf:!0}),this.orderFormDetails.get("ploss").patchValue(null,{onlySelf:!0}),this.orderFormDetails.get("product_mv").patchValue(null,{onlySelf:!0})}customerCategorySelected(e){null!=e?(this.selectedCustomerCategory=e,this.http.get(this.commonService.getAPI()+"/dev/priceMasters/"+this.selectedProduct.price_code+"/"+this.selectedCustomerCategory.ID).subscribe(e=>{this.selectedPriceMaster=e.data,this.orderFormDetails.get("lc").patchValue(this.selectedPriceMaster.price,{onlySelf:!0}),this.orderFormDetails.get("ploss").patchValue(this.selectedPriceMaster.p_loss,{onlySelf:!0}),this.orderFormDetails.get("product_mv").patchValue(this.selectedPriceMaster.price_master_mv,{onlySelf:!0})})):(this.selectedCustomerCategory=e,this.orderFormDetails.get("lc").patchValue(null,{onlySelf:!0}),this.orderFormDetails.get("ploss").patchValue(null,{onlySelf:!0}),this.orderFormDetails.get("product_mv").patchValue(null,{onlySelf:!0}))}addItem(){this.item={product_code:this.orderFormDetails.get("product_code").value,selectedProduct:this.selectedProduct,price_code:this.selectedProduct.price_code,cust_category_id:this.orderFormDetails.get("customer_category_id").value,cust_category:this.selectedCustomerCategory,lc:this.orderFormDetails.get("lc").value,ploss:this.orderFormDetails.get("ploss").value,product_mv:this.orderFormDetails.get("product_mv").value,cust_mv:this.orderFormMaster.get("cust_mv").value,total_mv:this.orderFormDetails.get("product_mv").value+this.orderFormMaster.get("cust_mv").value,qty:this.orderFormDetails.get("qty").value,expected_gold:this.orderFormDetails.get("expected_gold").value,product_size:this.orderFormDetails.get("product_size").value,rm_id:this.orderFormDetails.get("rm_id").value},this.orderDetails.push(this.item),this.orderFormDetails.get("product_code").patchValue(null,{onlySelf:!0}),this.orderFormDetails.get("customer_category_id").patchValue(null,{onlySelf:!0}),this.orderFormDetails.get("lc").patchValue(null,{onlySelf:!0}),this.orderFormDetails.get("ploss").patchValue(null,{onlySelf:!0}),this.orderFormDetails.get("product_mv").patchValue(null,{onlySelf:!0}),this.orderFormDetails.get("qty").patchValue(null,{onlySelf:!0}),this.orderFormDetails.get("expected_gold").patchValue(null,{onlySelf:!0}),this.orderFormDetails.reset(),this.orderFormDetails.get("rm_id").setValue(48),this.selectedProduct=null,this.storage.set("orderDetails",this.orderDetails).subscribe(()=>{})}populateOrderFormDetails(e,t){this.orderFormDetails.patchValue({product_code:e.product_code,customer_category_id:e.cust_category.ID,lc:e.lc,ploss:e.ploss,product_mv:e.product_mv,product_size:e.product_size,expected_gold:e.expected_gold,rm_id:e.rm_id,qty:e.qty}),this.selectedProduct=e.selectedProduct}deleteItem(e){l().fire({title:"Confirmation",text:"Are you sure to delete ",icon:"info",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes,Delete It!"}).then(t=>{t.isConfirmed&&this.orderDetails.splice(e,1)})}clearOrder(){this.storage.delete("orderDetails").subscribe(()=>{this.orderDetails=[]}),this.storage.delete("orderMaster").subscribe(()=>{this.orderFormMaster.get("cust_id").patchValue(null,{onlySelf:!0}),this.orderFormMaster.get("cust_mv").patchValue(null,{onlySelf:!0}),this.orderFormMaster.get("agent_id").patchValue(null,{onlySelf:!0})})}getExpectedGoldDecimalValue(){this.expectedGold=this.orderFormDetails.get("expected_gold").value.length>=3?this.orderFormDetails.get("expected_gold").value/1e3:this.orderFormDetails.get("expected_gold").value,this.orderFormDetails.get("expected_gold").patchValue(this.expectedGold,{onlySelf:!0})}saveOrder(){const e=this.orderDetails.map(({product_code:e,price_code:t,rm_id:r,product_size:o,expected_gold:i,qty:s,total_mv:a,ploss:n,cust_category_id:l,lc:c})=>({product_code:e,price_code:t,rm_id:r,product_size:o,expected_gold:i,qty:s,total_mv:a,ploss:n,cust_category_id:l,lc:c}));this.orderService.saveOrder(this.orderMaster,e).subscribe(e=>{!0===e.status&&(l().fire({title:"Done",text:"Order saved successfully",icon:"success"}),this.orderService.getOrderMasterList(this.pageSize).subscribe(e=>{this.orderMasterList=e.data}),this.storage.delete("orderDetails").subscribe(()=>{this.orderDetails=[]}),this.storage.delete("orderMaster").subscribe(()=>{this.orderFormMaster.reset()}))})}viewOrderList(){this.orderService.getOrderMasterList(this.pageSize).subscribe(e=>{this.orderMasterList=e.data})}viewOrderDetailsByOrderMaster(e){this.orderService.getOrderDetailsByOrderMaster(e).subscribe(e=>{this.printAbleOrderDetails=e.data,this.viewDetails=!0})}}return e.\u0275fac=function(t){return new(t||e)(d.Y36(u.v),d.Y36(g.R),d.Y36(h.eN),d.Y36(p.M),d.Y36(Z),d.Y36(R),d.Y36(W))},e.\u0275cmp=d.Xpm({type:e,selectors:[["app-order"]],decls:73,vars:15,consts:[["id","create-order-div"],["fxLayout","row","fxLayout.xs","column"],["fxFlex","40",1,"child-1"],["id","stock-form-div"],[3,"formGroup"],["fxLayout","row","fxLayout.xs","column","fxLayoutGap","15px",2,"padding-left","50px"],["fxFlex","90"],["bindLabel","agent_name","bindValue","agent_id","formControlName","agent_id","placeholder","Select Agent",1,"custom",3,"items","change"],["bindLabel","cust_name","bindValue","cust_id","formControlName","cust_id","placeholder","Select Customer",1,"custom",3,"items","change"],["fxFlex","20"],["type","number","matInput","","formControlName","cust_mv","placeholder","MV",1,"text-right"],["type","number","matInput","","formControlName","lc_discount_percentage","placeholder","LC Discount Percentage",1,"text-right"],["cfxLayout","row","fxLayout.xs","column","fxLayoutGap","15px","fxFlex","30"],["bindLabel","product_code","bindValue","product_code","formControlName","product_code","placeholder","Select Product",1,"custom",3,"items","virtualScroll","change"],["matBadgeOverlap","false",3,"matBadge",4,"ngIf"],["bindLabel","category","bindValue","ID","formControlName","customer_category_id","placeholder","Select Category",1,"custom",3,"items","change"],["fxFlex","10"],["type","number","matInput","","formControlName","lc","placeholder","LC",1,"text-right"],["type","number","matInput","","formControlName","ploss","placeholder","LC",1,"text-right"],["type","number","matInput","","formControlName","product_mv","placeholder","MV",1,"text-right"],["type","text","matInput","","formControlName","product_size","placeholder","Size",1,"text-right"],["fxFlex","15"],["type","text","matInput","","formControlName","expected_gold","placeholder","Gold",1,"text-right"],["type","number","matInput","","formControlName","qty","placeholder","Qty",1,"text-right"],["fxFlex","40",1,"example-button-row"],["mat-raised-button","","color","accent",3,"disabled","click"],[4,"ngIf"],["fxFlex","60",1,"child-2"],[1,"example-card"],[1,"example-form"],["fxLayout","","fxLayout.xs","column","fxLayoutAlign","start","fxLayoutGap","30px","fxLayoutGap.xs","0",1,"container"],["matInput","","placeholder","Search...","name","search","type","text","autofocus","",3,"ngModel","ngModelChange"],["matInput","","placeholder","Items per page","name","PageSize","type","text",3,"ngModel","ngModelChange"],["mat-raised-button","","color","accent",3,"click"],["id","developer-div",4,"ngIf"],["matBadgeOverlap","false",3,"matBadge"],[2,"text-align","right"],["mat-button","","color","primary","printSectionId","orderDetailsDiv","ngxPrint","",3,"printStyle"],["id","orderDetailsDiv"],[1,"table","table-bordered","table-responsive"],["colspan","4"],[1,"text-center"],[4,"ngFor","ngForOf"],["scope","row"],[1,"text-right"],["colspan","2",1,"text-center"],[1,"edit",3,"icon"],[2,"text-align","center"],["fxFlex","20",1,"example-button-row"],[1,"text-left"],[3,"routerLink","click"],["mat-button","",3,"click"],[1,"bi","bi-view-list"],["id","developer-div"],[1,"outerContainer"],["fxLayout","row","fxLayoutGap","1px","fxLayout.sm","column",1,"container"],["fxLayoutAlign","center center"],["fxFlex","2 1 auto","fxLayoutAlign","center center"]],template:function(e,t){1&e&&(d.TgZ(0,"div",0),d.TgZ(1,"div",1),d.TgZ(2,"div",2),d.TgZ(3,"mat-card",3),d.TgZ(4,"form",4),d.TgZ(5,"div",5),d.TgZ(6,"div",6),d.TgZ(7,"ng-select",7),d.NdJ("change",function(){return t.agentSelected()}),d.qZA(),d.qZA(),d.qZA(),d.TgZ(8,"div",5),d.TgZ(9,"div",6),d.TgZ(10,"ng-select",8),d.NdJ("change",function(e){return t.customerSelected(e)}),d.qZA(),d.qZA(),d.qZA(),d.TgZ(11,"div",5),d.TgZ(12,"mat-form-field",9),d.TgZ(13,"mat-label"),d._uU(14,"MV"),d.qZA(),d._UZ(15,"input",10),d.qZA(),d.TgZ(16,"mat-form-field",9),d.TgZ(17,"mat-label"),d._uU(18,"Disc. %"),d.qZA(),d._UZ(19,"input",11),d.qZA(),d.qZA(),d.qZA(),d.TgZ(20,"form",4),d.TgZ(21,"div",5),d.TgZ(22,"div",12),d.TgZ(23,"ng-select",13),d.NdJ("change",function(e){return t.productSelected(e)}),d.qZA(),d.YNc(24,le,1,1,"span",14),d.qZA(),d.TgZ(25,"div",12),d.TgZ(26,"ng-select",15),d.NdJ("change",function(e){return t.customerCategorySelected(e)}),d.qZA(),d.qZA(),d.qZA(),d.TgZ(27,"div",5),d.TgZ(28,"mat-form-field",16),d.TgZ(29,"mat-label"),d._uU(30,"LC"),d.qZA(),d._UZ(31,"input",17),d.qZA(),d.TgZ(32,"mat-form-field",16),d.TgZ(33,"mat-label"),d._uU(34,"Ploss"),d.qZA(),d._UZ(35,"input",18),d.qZA(),d.TgZ(36,"mat-form-field",16),d.TgZ(37,"mat-label"),d._uU(38,"Pr. MV"),d.qZA(),d._UZ(39,"input",19),d.qZA(),d.qZA(),d.TgZ(40,"div",5),d.TgZ(41,"mat-form-field",16),d.TgZ(42,"mat-label"),d._uU(43,"Size"),d.qZA(),d._UZ(44,"input",20),d.qZA(),d.TgZ(45,"mat-form-field",21),d.TgZ(46,"mat-label"),d._uU(47,"Exp. Gold"),d.qZA(),d._UZ(48,"input",22),d.qZA(),d.TgZ(49,"mat-form-field",16),d.TgZ(50,"mat-label"),d._uU(51,"Qty"),d.qZA(),d._UZ(52,"input",23),d.qZA(),d.TgZ(53,"div",24),d.TgZ(54,"button",25),d.NdJ("click",function(){return t.addItem()}),d._uU(55,"Add"),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.YNc(56,ue,37,8,"mat-card",26),d.qZA(),d.TgZ(57,"div",27),d.TgZ(58,"mat-card",28),d.TgZ(59,"mat-card-header"),d.TgZ(60,"form",29),d.TgZ(61,"div",30),d.TgZ(62,"mat-form-field",21),d.TgZ(63,"input",31),d.NdJ("ngModelChange",function(e){return t.searchTerm=e}),d.qZA(),d.qZA(),d.TgZ(64,"mat-form-field",16),d.TgZ(65,"input",32),d.NdJ("ngModelChange",function(e){return t.pageSize=e}),d.qZA(),d.qZA(),d.TgZ(66,"div",24),d.TgZ(67,"button",33),d.NdJ("click",function(){return t.viewOrderList()}),d._uU(68,"View Orders"),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.TgZ(69,"mat-card-content"),d.YNc(70,pe,38,2,"div",26),d.qZA(),d.qZA(),d.YNc(71,Ze,17,1,"mat-card",26),d.qZA(),d.qZA(),d.qZA(),d.YNc(72,_e,15,6,"div",34)),2&e&&(d.xp6(4),d.Q6J("formGroup",t.orderFormMaster),d.xp6(3),d.Q6J("items",t.agents),d.xp6(3),d.Q6J("items",t.customers),d.xp6(10),d.Q6J("formGroup",t.orderFormDetails),d.xp6(3),d.Q6J("items",t.products)("virtualScroll",!0),d.xp6(1),d.Q6J("ngIf",t.selectedProduct),d.xp6(2),d.Q6J("items",t.customerCategories),d.xp6(28),d.Q6J("disabled",!t.orderFormDetails.valid),d.xp6(2),d.Q6J("ngIf",t.printAbleOrderDetails),d.xp6(7),d.Q6J("ngModel",t.searchTerm),d.xp6(2),d.Q6J("ngModel",t.pageSize),d.xp6(5),d.Q6J("ngIf",t.orderDetails.length>0),d.xp6(1),d.Q6J("ngIf",!0),d.xp6(1),d.Q6J("ngIf",!t.isProduction))},directives:[$.xw,$.yH,X.a8,s._Y,s.JL,s.sg,$.SQ,ee.w9,s.JJ,s.u,te.KE,te.hX,s.wV,re.Nt,s.Fj,o.O5,oe.lW,X.dk,s.F,$.Wh,s.On,X.dn,ie.k,se.I,ae.Hw,o.sg,ne.BN,i.yS],pipes:[o.uU,o.JJ,o.Ts],styles:["#create-order-div[_ngcontent-%COMP%]{min-height:100vh;padding-left:35px}input[_ngcontent-%COMP%]::-webkit-outer-spin-button, input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}"]}),e})()}];let xe=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d.oAB({type:e}),e.\u0275inj=d.cJS({imports:[[i.Bz.forChild(ve)],i.Bz]}),e})();var ye=r(80291);let be=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d.oAB({type:e}),e.\u0275inj=d.cJS({imports:[[o.ez,xe,s.u5,s.UX,$.ae,ee.A0,ae.Ps,X.QW,ie.g,re.c,oe.ot,ne.uH,ye.pm,se.K]]}),e})()}}]);