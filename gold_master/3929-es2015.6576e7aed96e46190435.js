"use strict";(self.webpackChunkaccounts=self.webpackChunkaccounts||[]).push([[3929],{33929:function(e,t,o){o.r(t),o.d(t,{GoldReceivedModule:function(){return k}});var i=o(38583),n=o(63423),r=o(92340),l=o(3679),s=o(88259),c=o.n(s),d=o(37716),a=o(52541),u=o(82820),g=o(30535),p=o(86640),m=o(82613),h=o(98295),Z=o(49983),v=o(51095),f=o(26584),_=o(33013);function A(e,t){if(1&e&&(d.TgZ(0,"div",23),d.TgZ(1,"span"),d._uU(2),d.ALo(3,"number"),d.qZA(),d._uU(4," and "),d.TgZ(5,"span"),d._uU(6),d.qZA(),d.qZA()),2&e){const e=d.oxw();d.xp6(2),d.hij(" Gold Due: ",d.xi3(3,2,e.customerDues.gold_due,"1.3")," gm. "),d.xp6(4),d.hij(" LC Due: Rs. ",e.customerDues.lc_due,"")}}function q(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"div"),d.TgZ(1,"div"),d.TgZ(2,"mat-form-field",10),d.TgZ(3,"mat-label"),d._uU(4,"Enter Gold Rate(10Gm)"),d.qZA(),d.TgZ(5,"input",24,25),d.NdJ("keyup",function(){d.CHM(e);const t=d.MAs(6),o=d.MAs(12);return d.oxw().onGoldRateChange(t,o)}),d.qZA(),d.qZA(),d.qZA(),d.TgZ(7,"div"),d.TgZ(8,"mat-form-field",10),d.TgZ(9,"mat-label"),d._uU(10,"Enter Cash against Gold"),d.qZA(),d.TgZ(11,"input",26,27),d.NdJ("keyup",function(){d.CHM(e);const t=d.MAs(6),o=d.MAs(12);return d.oxw().onGoldRateChange(t,o)}),d.qZA(),d.qZA(),d.qZA(),d.qZA()}}function b(e,t){1&e&&(d.TgZ(0,"h3"),d._uU(1,"Gold Receipts"),d.qZA())}function T(e,t){1&e&&(d.TgZ(0,"h3"),d._uU(1,"No Receipts recorded"),d.qZA())}function R(e,t){1&e&&(d.TgZ(0,"tr"),d.TgZ(1,"th"),d._uU(2,"Date"),d.qZA(),d.TgZ(3,"th"),d._uU(4,"Receipt No."),d.qZA(),d.TgZ(5,"th"),d._uU(6,"Gold"),d.qZA(),d.qZA())}function x(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"tr"),d.TgZ(1,"td"),d._uU(2),d.qZA(),d.TgZ(3,"td",28),d.TgZ(4,"a",29),d.NdJ("click",function(){const t=d.CHM(e).$implicit;return d.oxw().onLcReceiptSelected(t)}),d._uU(5),d.qZA(),d.qZA(),d.TgZ(6,"td",28),d._uU(7),d.qZA(),d.qZA()}if(2&e){const e=t.$implicit;d.xp6(2),d.hij(" ",e.gold_receipt_date," "),d.xp6(3),d.Oqu(e.gold_receipt_id),d.xp6(2),d.hij(" ",e.gold_value," gm ")}}function N(e,t){if(1&e&&(d.TgZ(0,"div",30),d.TgZ(1,"div",0),d.TgZ(2,"div",31),d.TgZ(3,"pre"),d._uU(4),d.ALo(5,"json"),d.qZA(),d.qZA(),d.TgZ(6,"div",31),d.TgZ(7,"pre"),d._uU(8),d.ALo(9,"json"),d.qZA(),d.qZA(),d.TgZ(10,"div",31),d.TgZ(11,"pre"),d._uU(12),d.ALo(13,"json"),d.qZA(),d.qZA(),d.qZA(),d.qZA()),2&e){const e=d.oxw();d.xp6(4),d.hij("                goldReceiptForm=",d.lcZ(5,3,e.goldReceiptForm.value),"\n            "),d.xp6(4),d.hij("                afterSaveResponse= ",d.lcZ(9,5,e.afterSaveResponse),"\n            "),d.xp6(4),d.hij("                goldReceipts= ",d.lcZ(13,7,e.goldReceipts),"\n            ")}}const w=[{path:"",component:(()=>{class e{constructor(e,t,o,n){this.route=e,this.customerService=t,this.reportService=o,this.receiptService=n,this.isProduction=r.N.production,this.afterSaveResponse=null,this.selectedCustomer=null,this.showCashEntry=!1,this.route.data.subscribe(e=>{this.agents=e.goldReceiptResolver.agents.data,this.customers=e.goldReceiptResolver.customers.data});const s=new Date,c=(0,i.p6)(s,"yyyy-MM-dd","en");this.goldReceiptForm=new l.cw({gold_receipt_date:new l.NI(c),agent_id:new l.NI(null,[l.kI.required]),cust_id:new l.NI(null,[l.kI.required]),rm_id:new l.NI(36,[l.kI.required]),payment_mode:new l.NI("1",[l.kI.required]),gold_value:new l.NI(null,[l.kI.required,l.kI.min(.001)]),discount:new l.NI(0),gold_rate:new l.NI(6e4),cash:new l.NI(0),last_gold_balance:new l.NI(0,[l.kI.required]),current_lc_balance:new l.NI(0,[l.kI.required])})}ngOnInit(){this.onPaymentModeValueChanged()}agentSelected(){}onCustomerSelected(e){this.selectedCustomer=e.cust_id,this.afterSaveResponse=null,this.customerService.getCustomerDues(e.cust_id).subscribe(e=>{console.log("value changed",e.data),this.customerDues=e.data,this.goldReceiptForm.patchValue({last_gold_balance:this.customerDues.gold_due,current_lc_balance:this.customerDues.lc_due})}),this.receiptService.getGoldReceiptsByCustomer(this.selectedCustomer).subscribe(e=>{this.goldReceipts=e.data})}saveGoldReceipt(){this.receiptService.saveGoldReceipt(this.goldReceiptForm.value).subscribe(e=>{!0===e.status&&(c().fire({title:"Done",text:"Gold Received added successfully",icon:"success"}),this.customerDues.lc_due=this.customerDues.lc_due-this.goldReceiptForm.value.amount,this.afterSaveResponse=e.data,this.goldReceiptForm.markAsPristine(),this.goldReceipts.unshift(this.afterSaveResponse.gold_receipt))},e=>{c().fire({title:"Done",text:"Error saving Gold Receipt",icon:"error"})})}resetForm(){this.goldReceiptForm.reset(),this.customerDues=null}onLcReceiptSelected(e){}onGoldRateChange(e,t){if(console.log("Gold rate",e.value),console.log("cash",t.value),Number(t.value)>0&&Number(e.value)>0){const o=(Number(t.value)/(Number(e.value)/10)).toFixed(3);this.goldReceiptForm.patchValue({gold_value:o})}else this.goldReceiptForm.patchValue({gold_value:null})}onPaymentModeValueChanged(){this.goldReceiptForm.get("payment_mode").valueChanges.subscribe(e=>{this.showCashEntry="2"===e})}}return e.\u0275fac=function(t){return new(t||e)(d.Y36(n.gz),d.Y36(a.v),d.Y36(u.r),d.Y36(g.V))},e.\u0275cmp=d.Xpm({type:e,selectors:[["app-gold-received"]],decls:35,vars:10,consts:[[1,"d-flex","flex-row"],[1,"p-2","col-4"],[3,"formGroup"],["bindLabel","agent_name","bindValue","agent_id","formControlName","agent_id","placeholder","Select Agent",1,"custom",3,"items","change"],["bindLabel","cust_name","bindValue","cust_id","formControlName","cust_id","placeholder","Select Customer",1,"custom",3,"items","change"],["class","border-glow",4,"ngIf"],["aria-label","Select an option","formControlName","payment_mode",1,"payment-mode"],["value","1"],["value","2"],[4,"ngIf"],[1,"example-full-width"],["type","number","step","0.001","matInput","","formControlName","gold_value","placeholder","Gold Value",1,"text-right"],[1,"d-flex","flex-row","bd-highlight","mb-3"],[1,"p-2","bd-highlight"],[1,"example-button-row"],["mat-button","","color","primary",1,"text-right",3,"click"],["mat-button","","color","primary",1,"text-right",3,"disabled","click"],[1,"p-2","col-8"],[3,"value"],["myTab",""],["pTemplate","header"],["pTemplate","body"],["id","developer-div",4,"ngIf"],[1,"border-glow"],["type","number","matInput","","formControlName","gold_rate","placeholder","Gold Rate",1,"text-right",3,"keyup"],["goldRate",""],["type","number","matInput","","formControlName","cash","placeholder","Cash",1,"text-right",3,"keyup"],["cash",""],[1,"text-right"],[3,"routerLink","click"],["id","developer-div"],[1,"p-2"]],template:function(e,t){1&e&&(d.TgZ(0,"div",0),d.TgZ(1,"div",1),d.TgZ(2,"form",2),d.TgZ(3,"ng-select",3),d.NdJ("change",function(){return t.agentSelected()}),d.qZA(),d.TgZ(4,"ng-select",4),d.NdJ("change",function(e){return t.onCustomerSelected(e)}),d.qZA(),d.YNc(5,A,7,5,"div",5),d.TgZ(6,"div"),d.TgZ(7,"mat-radio-group",6),d.TgZ(8,"mat-radio-button",7),d._uU(9,"In Gold"),d.qZA(),d.TgZ(10,"mat-radio-button",8),d._uU(11,"In Cash"),d.qZA(),d.qZA(),d.qZA(),d.YNc(12,q,13,0,"div",9),d.TgZ(13,"div"),d.TgZ(14,"mat-form-field",10),d.TgZ(15,"mat-label"),d._uU(16,"Enter Gold Received"),d.qZA(),d._UZ(17,"input",11),d.qZA(),d.qZA(),d.TgZ(18,"div",12),d.TgZ(19,"div",13),d.TgZ(20,"div",14),d.TgZ(21,"button",15),d.NdJ("click",function(){return t.resetForm()}),d._uU(22,"Reset"),d.qZA(),d.qZA(),d.qZA(),d.TgZ(23,"div",13),d.TgZ(24,"div",14),d.TgZ(25,"button",16),d.NdJ("click",function(){return t.saveGoldReceipt()}),d._uU(26,"Save Record"),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.TgZ(27,"div",17),d.YNc(28,b,2,0,"h3",9),d.YNc(29,T,2,0,"h3",9),d.TgZ(30,"p-table",18,19),d.YNc(32,R,7,0,"ng-template",20),d.YNc(33,x,8,3,"ng-template",21),d.qZA(),d.qZA(),d.qZA(),d.YNc(34,N,14,9,"div",22)),2&e&&(d.xp6(2),d.Q6J("formGroup",t.goldReceiptForm),d.xp6(1),d.Q6J("items",t.agents),d.xp6(1),d.Q6J("items",t.customers),d.xp6(1),d.Q6J("ngIf",t.customerDues),d.xp6(7),d.Q6J("ngIf",t.showCashEntry),d.xp6(13),d.Q6J("disabled",!t.goldReceiptForm.valid||t.goldReceiptForm.pristine),d.xp6(3),d.Q6J("ngIf",t.goldReceipts&&t.goldReceipts.length>0),d.xp6(1),d.Q6J("ngIf",!t.goldReceipts||0==t.goldReceipts.length),d.xp6(1),d.Q6J("value",t.goldReceipts),d.xp6(4),d.Q6J("ngIf",!t.isProduction))},directives:[l._Y,l.JL,l.sg,p.w9,l.JJ,l.u,i.O5,m.VQ,m.U0,h.KE,h.hX,l.wV,Z.Nt,l.Fj,v.lW,f.iA,_.jx,n.yS],pipes:[i.JJ,i.Ts],styles:[".payment-mode[_ngcontent-%COMP%]   mat-radio-button[_ngcontent-%COMP%]{margin-left:16px}.border-glow[_ngcontent-%COMP%]{padding:2px;border-color:#28a745;box-shadow:0 0 0 .2rem #28a74540;border-radius:5px;margin-bottom:5px}"]}),e})()}];let C=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d.oAB({type:e}),e.\u0275inj=d.cJS({imports:[[n.Bz.forChild(w)],n.Bz]}),e})();var I=o(76627),y=o(95913);let k=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d.oAB({type:e}),e.\u0275inj=d.cJS({imports:[[i.ez,C,l.UX,p.A0,h.lN,m.Fk,I.Ps,y.K,v.ot,Z.c,f.U$]]}),e})()}}]);