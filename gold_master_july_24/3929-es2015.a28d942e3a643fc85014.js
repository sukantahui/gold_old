"use strict";(self.webpackChunkaccounts=self.webpackChunkaccounts||[]).push([[3929],{33929:function(e,t,o){o.r(t),o.d(t,{GoldReceivedModule:function(){return k}});var n=o(38583),i=o(63423),r=o(92340),c=o(3679),l=o(88259),s=o.n(l),a=o(37716),d=o(52541),u=o(82820),g=o(30535),p=o(86640),m=o(82613),h=o(98295),Z=o(49983),v=o(51095),f=o(26584),_=o(33013);function A(e,t){if(1&e&&(a.TgZ(0,"div",23),a.TgZ(1,"span"),a._uU(2),a.ALo(3,"number"),a.qZA(),a._uU(4," and "),a.TgZ(5,"span"),a._uU(6),a.qZA(),a.qZA()),2&e){const e=a.oxw();a.xp6(2),a.hij(" Gold Due: ",a.xi3(3,2,e.customerDues.gold_due,"1.3")," gm. "),a.xp6(4),a.hij(" LC Due: Rs. ",e.customerDues.lc_due,"")}}function b(e,t){if(1&e){const e=a.EpF();a.TgZ(0,"div"),a.TgZ(1,"div"),a.TgZ(2,"mat-form-field",10),a.TgZ(3,"mat-label"),a._uU(4,"Enter Gold Rate(10Gm)"),a.qZA(),a.TgZ(5,"input",24,25),a.NdJ("keyup",function(){a.CHM(e);const t=a.MAs(6),o=a.MAs(12);return a.oxw().onGoldRateChange(t,o)}),a.qZA(),a.qZA(),a.qZA(),a.TgZ(7,"div"),a.TgZ(8,"mat-form-field",10),a.TgZ(9,"mat-label"),a._uU(10,"Enter Cash against Gold"),a.qZA(),a.TgZ(11,"input",26,27),a.NdJ("keyup",function(){a.CHM(e);const t=a.MAs(6),o=a.MAs(12);return a.oxw().onGoldRateChange(t,o)}),a.qZA(),a.qZA(),a.qZA(),a.qZA()}}function q(e,t){1&e&&(a.TgZ(0,"h3"),a._uU(1,"Gold Receipts"),a.qZA())}function T(e,t){1&e&&(a.TgZ(0,"h3"),a._uU(1,"No Receipts recorded"),a.qZA())}function R(e,t){1&e&&(a.TgZ(0,"tr"),a.TgZ(1,"th"),a._uU(2,"Date"),a.qZA(),a.TgZ(3,"th"),a._uU(4,"Receipt No."),a.qZA(),a.TgZ(5,"th"),a._uU(6,"Gold"),a.qZA(),a.qZA())}function x(e,t){if(1&e){const e=a.EpF();a.TgZ(0,"tr"),a.TgZ(1,"td"),a._uU(2),a.qZA(),a.TgZ(3,"td",28),a.TgZ(4,"a",29),a.NdJ("click",function(){const t=a.CHM(e).$implicit;return a.oxw().onLcReceiptSelected(t)}),a._uU(5),a.qZA(),a.qZA(),a.TgZ(6,"td",28),a._uU(7),a.qZA(),a.qZA()}if(2&e){const e=t.$implicit;a.xp6(2),a.hij(" ",e.gold_receipt_date," "),a.xp6(3),a.Oqu(e.gold_receipt_id),a.xp6(2),a.hij(" ",e.gold_value," gm ")}}function w(e,t){if(1&e&&(a.TgZ(0,"div",30),a.TgZ(1,"div",0),a.TgZ(2,"div",31),a.TgZ(3,"pre"),a._uU(4),a.ALo(5,"json"),a.qZA(),a.qZA(),a.TgZ(6,"div",31),a.TgZ(7,"pre"),a._uU(8),a.ALo(9,"json"),a.qZA(),a.qZA(),a.TgZ(10,"div",31),a.TgZ(11,"pre"),a._uU(12),a.ALo(13,"json"),a.qZA(),a.qZA(),a.qZA(),a.qZA()),2&e){const e=a.oxw();a.xp6(4),a.hij("                goldReceiptForm=",a.lcZ(5,3,e.goldReceiptForm.value),"\n            "),a.xp6(4),a.hij("                afterSaveResponse= ",a.lcZ(9,5,e.afterSaveResponse),"\n            "),a.xp6(4),a.hij("                goldReceipts= ",a.lcZ(13,7,e.goldReceipts),"\n            ")}}const N=[{path:"",component:(()=>{class e{constructor(e,t,o,i){this.route=e,this.customerService=t,this.reportService=o,this.receiptService=i,this.isProduction=r.N.production,this.afterSaveResponse=null,this.selectedCustomer=null,this.showCashEntry=!1,this.route.data.subscribe(e=>{this.agents=e.goldReceiptResolver.agents.data,this.customers=e.goldReceiptResolver.customers.data});const l=new Date,s=(0,n.p6)(l,"yyyy-MM-dd","en");this.goldReceiptForm=new c.cw({gold_receipt_date:new c.NI(s),agent_id:new c.NI(null,[c.kI.required]),cust_id:new c.NI(null,[c.kI.required]),rm_id:new c.NI(36,[c.kI.required]),payment_mode:new c.NI("1",[c.kI.required]),gold_value:new c.NI(null,[c.kI.required,c.kI.min(.001)]),discount:new c.NI(0),gold_rate:new c.NI(6e4),cash:new c.NI(0),last_gold_balance:new c.NI(0,[c.kI.required]),current_lc_balance:new c.NI(0,[c.kI.required])})}ngOnInit(){this.onPaymentModeValueChanged()}agentSelected(){}onCustomerSelected(e){this.selectedCustomer=e.cust_id,this.afterSaveResponse=null,this.customerService.getCustomerDues(e.cust_id).subscribe(e=>{console.log("value changed",e.data),this.customerDues=e.data,this.goldReceiptForm.patchValue({last_gold_balance:this.customerDues.gold_due,current_lc_balance:this.customerDues.lc_due})}),this.receiptService.getGoldReceiptsByCustomer(this.selectedCustomer).subscribe(e=>{this.goldReceipts=e.data})}saveGoldReceipt(){this.receiptService.saveGoldReceipt(this.goldReceiptForm.value).subscribe(e=>{!0===e.status&&(s().fire({title:"Done",text:"Gold Received added successfully",icon:"success"}),this.customerDues.lc_due=this.customerDues.lc_due-this.goldReceiptForm.value.amount,this.afterSaveResponse=e.data,this.goldReceiptForm.markAsPristine(),this.goldReceipts.unshift(this.afterSaveResponse.gold_receipt))},e=>{s().fire({title:"Done",text:"Error saving Gold Receipt",icon:"error"})})}resetForm(){this.goldReceiptForm.reset(),this.customerDues=null}onLcReceiptSelected(e){}onGoldRateChange(e,t){if(console.log("Gold rate",e.value),console.log("cash",t.value),Number(t.value)>0&&Number(e.value)>0){const o=(Number(t.value)/(Number(e.value)/10)).toFixed(3);this.goldReceiptForm.patchValue({gold_value:o})}else this.goldReceiptForm.patchValue({gold_value:null})}onPaymentModeValueChanged(){this.goldReceiptForm.get("payment_mode").valueChanges.subscribe(e=>{this.showCashEntry="2"===e})}}return e.\u0275fac=function(t){return new(t||e)(a.Y36(i.gz),a.Y36(d.v),a.Y36(u.r),a.Y36(g.V))},e.\u0275cmp=a.Xpm({type:e,selectors:[["app-gold-received"]],decls:35,vars:10,consts:[[1,"d-flex","flex-row"],[1,"p-2","col-4"],[3,"formGroup"],["bindLabel","agent_name","bindValue","agent_id","formControlName","agent_id","placeholder","Select Agent",1,"custom",3,"items","change"],["bindLabel","cust_name","bindValue","cust_id","formControlName","cust_id","placeholder","Select Customer",1,"custom",3,"items","change"],["class","border-glow",4,"ngIf"],["aria-label","Select an option","formControlName","payment_mode",1,"payment-mode"],["value","1"],["value","2"],[4,"ngIf"],[1,"example-full-width"],["type","number","step","0.001","matInput","","formControlName","gold_value","placeholder","Gold Value",1,"text-right"],[1,"d-flex","flex-row","bd-highlight","mb-3"],[1,"p-2","bd-highlight"],[1,"example-button-row"],["mat-button","","color","primary",1,"text-right",3,"click"],["mat-button","","color","primary",1,"text-right",3,"disabled","click"],[1,"p-2","col-8"],[3,"value"],["myTab",""],["pTemplate","header"],["pTemplate","body"],["id","developer-div",4,"ngIf"],[1,"border-glow"],["type","number","matInput","","formControlName","gold_rate","placeholder","Gold Rate",1,"text-right",3,"keyup"],["goldRate",""],["type","number","matInput","","formControlName","cash","placeholder","Cash",1,"text-right",3,"keyup"],["cash",""],[1,"text-right"],[3,"routerLink","click"],["id","developer-div"],[1,"p-2"]],template:function(e,t){1&e&&(a.TgZ(0,"div",0),a.TgZ(1,"div",1),a.TgZ(2,"form",2),a.TgZ(3,"ng-select",3),a.NdJ("change",function(){return t.agentSelected()}),a.qZA(),a.TgZ(4,"ng-select",4),a.NdJ("change",function(e){return t.onCustomerSelected(e)}),a.qZA(),a.YNc(5,A,7,5,"div",5),a.TgZ(6,"div"),a.TgZ(7,"mat-radio-group",6),a.TgZ(8,"mat-radio-button",7),a._uU(9,"In Gold"),a.qZA(),a.TgZ(10,"mat-radio-button",8),a._uU(11,"In Cash"),a.qZA(),a.qZA(),a.qZA(),a.YNc(12,b,13,0,"div",9),a.TgZ(13,"div"),a.TgZ(14,"mat-form-field",10),a.TgZ(15,"mat-label"),a._uU(16,"Enter Gold Received"),a.qZA(),a._UZ(17,"input",11),a.qZA(),a.qZA(),a.TgZ(18,"div",12),a.TgZ(19,"div",13),a.TgZ(20,"div",14),a.TgZ(21,"button",15),a.NdJ("click",function(){return t.resetForm()}),a._uU(22,"Reset"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(23,"div",13),a.TgZ(24,"div",14),a.TgZ(25,"button",16),a.NdJ("click",function(){return t.saveGoldReceipt()}),a._uU(26,"Save Record"),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.TgZ(27,"div",17),a.YNc(28,q,2,0,"h3",9),a.YNc(29,T,2,0,"h3",9),a.TgZ(30,"p-table",18,19),a.YNc(32,R,7,0,"ng-template",20),a.YNc(33,x,8,3,"ng-template",21),a.qZA(),a.qZA(),a.qZA(),a.YNc(34,w,14,9,"div",22)),2&e&&(a.xp6(2),a.Q6J("formGroup",t.goldReceiptForm),a.xp6(1),a.Q6J("items",t.agents),a.xp6(1),a.Q6J("items",t.customers),a.xp6(1),a.Q6J("ngIf",t.customerDues),a.xp6(7),a.Q6J("ngIf",t.showCashEntry),a.xp6(13),a.Q6J("disabled",!t.goldReceiptForm.valid||t.goldReceiptForm.pristine),a.xp6(3),a.Q6J("ngIf",t.goldReceipts&&t.goldReceipts.length>0),a.xp6(1),a.Q6J("ngIf",!t.goldReceipts||0==t.goldReceipts.length),a.xp6(1),a.Q6J("value",t.goldReceipts),a.xp6(4),a.Q6J("ngIf",!t.isProduction))},directives:[c._Y,c.JL,c.sg,p.w9,c.JJ,c.u,n.O5,m.VQ,m.U0,h.KE,h.hX,c.wV,Z.Nt,c.Fj,v.lW,f.iA,_.jx,i.yS],pipes:[n.JJ,n.Ts],styles:[".payment-mode[_ngcontent-%COMP%]   mat-radio-button[_ngcontent-%COMP%]{margin-left:16px}.border-glow[_ngcontent-%COMP%]{padding:2px;border-color:#28a745;box-shadow:0 0 0 .2rem #28a74540;border-radius:5px;margin-bottom:5px}input[_ngcontent-%COMP%]::-webkit-outer-spin-button, input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}"]}),e})()}];let C=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=a.oAB({type:e}),e.\u0275inj=a.cJS({imports:[[i.Bz.forChild(N)],i.Bz]}),e})();var y=o(76627),I=o(95913);let k=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=a.oAB({type:e}),e.\u0275inj=a.cJS({imports:[[n.ez,C,c.UX,p.A0,h.lN,m.Fk,y.Ps,I.K,v.ot,Z.c,f.U$]]}),e})()}}]);