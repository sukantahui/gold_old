<div id="transfer-to-agent-div">
    <h3>Transfer to Agent</h3>
    <div class="d-flex flex-row bd-highlight mb-3">
        <div class="col-6 flex-column">
            <form [formGroup]=transferForm class="row g-3" fxFlex="30">
                <ng-select [items]="agents"
                           bindLabel="agent_name"
                           class="custom"
                           bindValue="agent_id"
                           formControlName="agentId"
                           placeholder="Select Agent">
                </ng-select>
            </form>

        </div>
        <div class="col-6">

        </div>
    </div>
    <div class="d-flex flex-row bd-highlight mb-3">

        <div class="col-6 flex-column">
            <div  id="product-table-div">
                <form class="example-form">
                    <div class="d-flex flex-column">
                        <div class="d-flex justify-content-around">
                            <div class="p-2">
                                <mat-slide-toggle
                                        [(ngModel)]="checkedAvailableAllProducts"
                                        class="example-margin"
                                        [color]="color"
                                        (change)="changeProductSlideToggle()"
                                        [ngModelOptions]="{standalone: true}">
                                    {{checkedAvailableAllProducts?'Deselect':'Select All'}}
                                </mat-slide-toggle>
                            </div>
                            <div class="p-2">

                                <span class="nl-2 p-input-icon-left">
                                    <i class="pi pi-search"></i>
                                    <input class="form-control text-right" pInputText [(ngModel)]="searchTerm" name="search">

                                </span>
                            </div>
                            <div class="p-2">
                                <input class="form-control col-3" pInputText [(ngModel)]="pageSize" name="PageSize">
                            </div>
                            <div class="p-2">
                                <input class="form-control" pInputText [disabled]="true" value="{{countSelectedAvailableProduct()}}/{{products.length}}" name="totalProducts">
<!--                                <span class="ml-2 p-input-icon-left">-->
<!--                                    <input type="text" pInputText [disabled]="true" value="{{countSelectedAvailableProduct()}}/{{products.length}}" name="totalProducts"/>-->
<!--                                </span>-->
                            </div>
                            <div class="p-2">
                                <button (click)="selectForTransfer()" [disabled]="!isAnyAvailableProductSelected()"   mat-mini-fab aria-label="Send all"  [matBadge]="countSelectedAvailableProduct()" matBadgePosition="before" matBadgeColor="primary">
                                    <i class="ri-send-plane-2-fill"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div>
                        <span class="nl-2 p-input-icon-left">
                            <i class="pi pi-search"></i>
                            <input type="text" class="text-right" pInputText placeholder="Enter tag..." #myInput (click)="myInput.select()" [(ngModel)]="searchTag" name="search"  (blur)="selectForDirectTagTransfer()">
                        </span>
<!--                        <mat-form-field fxFlex="15">-->
<!--                            <input matInput placeholder="Enter tag..." #myInput (click)="myInput.select()" [(ngModel)]="searchTag" name="search" type="text" (blur)="selectForDirectTagTransfer()">-->
<!--                        </mat-form-field>-->
                    </div>
                </form>

                <table matSort (matSortChange)="sortData($event)" class="table table-bordered table-responsive" style="border: none !important;">

                    <thead>
                    <tr>
                        <th mat-sort-header="selected">Select</th>
                        <th>Index</th>
                        <th mat-sort-header="tag">Tag</th>
                        <th mat-sort-header="model">Model</th>
                        <th mat-sort-header="model">Model</th>
                        <th mat-sort-header="size">Size</th>
                        <th mat-sort-header="quantity">Quantity</th>
                        <th>Gold</th>
                        <th>LC</th>
                        <th>Selected</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr [ngClass]="{selectedRow: product.is_selected}" *ngFor="let product of sortedProducts | filter:searchTerm | filter:searchTag | paginate: {id: 'pagination1', itemsPerPage: pageSize, currentPage: currentPageProducts };let indexOfElement=index">
<!--                        <td><mat-checkbox class="example-margin" [(ngModel)]="product.is_selected"></mat-checkbox></td>-->
                        <td><mat-checkbox class="example-margin" [(ngModel)]="product.is_selected"></mat-checkbox></td>
                        <td>{{(currentPageProducts-1)*10+indexOfElement+1}}</td>
                        <td>{{product.tag}}</td>
                        <td>{{product.model_no}}</td>
                        <td>{{product.model_size}}</td>
                        <td>{{product.qty}}</td>
                        <td>{{product.gold}}</td>
                        <td>{{product.labour_charge}}</td>
                        <td>{{product.is_selected}}</td>
                        <td>
<!--                            <button (click)="sendProduct(product)" [disabled]="!product.is_selected" mat-mini-fab aria-label="Select Product">-->
<!--                                <i class="ri-send-plane-2-fill"></i>-->
<!--                            </button>-->
                        </td>
                    </tr>
                    </tbody>

                </table>


                <div fxLayout.xs="column" fxLayout="column" fxFlexFill>
                    <!--    https://www.npmjs.com/package/ngx-pagination-->
                    <!--    npm i ngx-pagination-->
                    <pagination-controls id='pagination1' (pageChange)="currentPageProducts = $event" responsive="true" autoHide="true" previousLabel="আগে" nextLabel="পরে" screenReaderPaginationLabel="Pagination" screenReaderPageLabel="page" directionLinks="true">
                    </pagination-controls>
                </div>
            </div>
        </div>
        <div class="col-6 flex-column">
            <div  id="selected-product-table-div">
                <form class="example-form">
                    <div class="container" fxLayout fxLayout.xs="column" fxLayoutAlign="start" fxLayoutGap="30px" fxLayoutGap.xs="0">
                        <mat-slide-toggle
                                [(ngModel)]="checkedTransferableAllProducts"
                                class="example-margin"
                                [color]="color"
                                (change)="changeTransferableProductSlideToggle()"
                                [ngModelOptions]="{standalone: true}">
                            {{checkedTransferableAllProducts?'Deselect':'Select All'}}
                        </mat-slide-toggle>
                        <mat-form-field class="example-full-width">
                            <input matInput placeholder="Search..." [(ngModel)]="searchTermSelectedProducts" name="search" type="text" autofocus>
                        </mat-form-field>
                        <mat-form-field class="example-full-width">
                            <input matInput placeholder="Items per page" [(ngModel)]="pageSizeSelectedProducts" name="PageSize" type="text">
                        </mat-form-field>
                    </div>
                </form>
                <table class="table table-bordered table-responsive" style="border: none !important;">

                <thead>
                <tr>
                    <td>Select</td>
                    <td>Index</td>
                    <td>Tag</td>
                    <td>Model</td>
                    <td>Size</td>
                    <td>Quantity</td>
                    <td>Gold</td>
                    <td>LC</td>
                    <td>Selected</td>
                    <td>Delete</td>
                </tr>
                </thead>
                <tbody>
                <tr *ngFor="let product of selectedProducts| filter:searchTermSelectedProducts | paginate: {id: 'pagination2', itemsPerPage: pageSizeSelectedProducts, currentPage: currentPageSelectedProducts };let indexOfElement=index">
                    <td><mat-checkbox class="example-margin" [(ngModel)]="product.is_selected"></mat-checkbox></td>
                    <td>{{(currentPageSelectedProducts-1)*10+indexOfElement+1}}</td>
                    <td>{{product.tag}}</td>
                    <td>{{product.model_no}}</td>
                    <td>{{product.model_size}}</td>
                    <td>{{product.qty}}</td>
                    <td>{{product.gold}}</td>
                    <td>{{product.labour_charge}}</td>
                    <td>{{product.is_selected}}</td>
                    <td>
                        <button mat-button (click)="deleteFromSelectedProducts(product)" style="color: red"><mat-icon>delete</mat-icon></button>
                    </td>
                </tr>
                </tbody>
            </table>
            <div fxLayout.xs="column" fxLayout="column" fxFlexFill>
                    <!--    https://www.npmjs.com/package/ngx-pagination-->
                    <!--    npm i ngx-pagination-->
                    <pagination-controls id='pagination2' (pageChange)="currentPageSelectedProducts = $event" responsive="true" autoHide="true" previousLabel="আগে" nextLabel="পরে" screenReaderPaginationLabel="Pagination" screenReaderPageLabel="page" directionLinks="true">
                    </pagination-controls>
            </div>

                <button *ngIf="getSelectedAgentName().length>1 && selectedProducts.length>0" mat-button color="primary" (click)="transferToAgent()">Send to {{getSelectedAgentName()}}</button>

            </div>
        </div>
    </div>
</div>




