<div id="agent-wise-sale-report-div">
    <mat-card class="example-card">
        <mat-card-header>
            <div mat-card-avatar class="example-header-image"></div>
            <mat-card-title>Agent Wise Sale Report</mat-card-title>
        </mat-card-header>
        <mat-card-content>
            <form [formGroup]="agentWiseSaleReportForm">
            <div class="d-flex justify-content-between">
                <div class="p-2 col-6 d-flex justify-content-between">

                    <div class="p-2">
                        <div class="p-field p-col-12 p-md-4">
                            <label for="spanish">Start Date</label>
                            <p-calendar [(ngModel)]="date3" [showIcon]="true" [locale]="es" dateFormat="dd/mm/yy" inputId="spanish"></p-calendar>
                        </div>
                    </div>
                    <div class="p-2">
                        <div class="p-field p-col-12 p-md-4">
                            <label for="endDate">End Date</label>
                            <p-calendar formControlName="end_date" [locale]="es" dateFormat="dd/mm/yy" inputId="endDate"></p-calendar>
                        </div>
                    </div>
                </div>
                <div class="p-2 col-6 ">
                    <div class="col-9">
                        <ng-select [items]="agentList"
                                   bindLabel="agent_name"
                                   class="custom"
                                   bindValue="agent_id"
                                   formControlName="agent_id"
                                   placeholder="Select Agent">
                        </ng-select>
                    </div>
                    <div class="example-button-row" fxFlex="20">
                        <button mat-button color="primary" (click)="getReport()">Search</button>
                    </div>
                </div>
            </div>
            </form>

        </mat-card-content>
    </mat-card>

    <mat-card class="example-card" *ngIf="agentWiseSale" >
        <div style="text-align: right">
            <button
                    mat-button color="primary"
                    [printStyle]="printDivStyle"
                    printSectionId="printAgentwiseSalesReportDiv"
                    ngxPrint ><mat-icon>print</mat-icon>
            </button>
        </div>
        <div id="printAgentwiseSalesReportDiv">
            <mat-card-header>
                <div mat-card-avatar class="example-header-image"></div>
                <mat-card-title class="text-center">Sales Report for Agent: {{agentWiseSaleReportForm.get('agent_id').value}}</mat-card-title>
            </mat-card-header>
            <mat-card-content>


                <div class="no-print">
                    <mat-slide-toggle
                            [(ngModel)]="isAllCustomers"
                            class="example-margin"
                            (change)="isAllCustomersChanged()">
                        {{isAllCustomers? "All Customers":"Active Customers for selected period"}}
                    </mat-slide-toggle>
                </div>


                <table matSort (matSortChange)="sortData($event)" class="table table-bordered table-responsive">
                    <thead>
                    <tr>
                        <th class="text-center">SL</th>
                        <th class="text-center" mat-sort-header="cust_name">Customer</th>
                        <th class="text-center" mat-sort-header="qty">Qty</th>
                        <th class="text-center" mat-sort-header="fine_gold">Billed Gold</th>
                        <th class="text-center" mat-sort-header="lc">Billed LC</th>
                        <th class="text-center" mat-sort-header="gold_received">Gold Received</th>
                        <th class="text-center" mat-sort-header="lc_received">LC Received</th>
                        <th class="text-center" >Net Gold</th>
                        <th class="text-center" >Net LC</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr *ngFor="let row of agentWiseSale; let i = index">
                        <ng-container *ngIf="true">
                            <th scope="row">{{i+1}}</th>
                            <td class="text-left">{{row.cust_name}}</td>
                            <td class="text-right">{{row.qty}}</td>
                            <td class="text-right" >{{row.fine_gold | number: '1.3'}}</td>
                            <td class="text-right">{{row.lc}}</td>
                            <td class="text-right">{{row.gold_received | number: '1.3'}}</td>
                            <td class="text-right">{{row.lc_received}}</td>
                            <td class="text-right" [ngClass]="{'positive' : (row.fine_gold - row.gold_received) > 0,'negative' : (row.fine_gold - row.gold_received) < 0}">{{(row.fine_gold - row.gold_received) | number: '1.3'}}</td>
                            <td class="text-right" [ngClass]="{'positive' : (row.lc - row.lc_received) > 0,'negative' : (row.lc - row.lc_received) < 0}">{{row.lc - row.lc_received}}</td>
                        </ng-container>
                    </tr>

                    </tbody>
                    <tfoot>
                    <tr>
                        <th colspan="2" class="text-center">Total</th>
                        <th class="text-right">{{qtyTotal}}</th>
                        <th class="text-right">{{billedGoldTotal | number: '1.3'}}</th>
                        <th class="text-right">{{billedLcTotal}}</th>
                        <th class="text-right">{{goldReceivedTotal | number: '1.3'}}</th>
                        <th class="text-right">{{lcReceivedTotal}}</th>
                        <th class="text-right" [ngClass]="{'positive' : (billedGoldTotal-goldReceivedTotal) > 0,'negative' : (billedGoldTotal-goldReceivedTotal) < 0}">{{(billedGoldTotal-goldReceivedTotal) | number: '1.3' }}</th>
                        <th class="text-right" [ngClass]="{'positive' : (billedLcTotal - lcReceivedTotal) > 0,'negative' : (billedLcTotal - lcReceivedTotal) < 0}">{{billedLcTotal - lcReceivedTotal}}</th>
                    </tr>
                    </tfoot>
                </table>
            </mat-card-content>
        </div>

    </mat-card>

</div>


<div *ngIf="false" id="developer-div">
    <pre>

    </pre>
    <pre>
        startDate = {{startDate | json}}
        endDate = {{endDate | json}}
    </pre>
    <pre>

    </pre>
</div>
